(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(let n in e)t(e[n],n)}function n(e,t){e.forEach(t)}function r(e,t){if(!e)throw Error(t)}function a({node:e=[],from:t,source:r,parent:a=t||r,to:s,target:o,child:i=s||o,scope:l={},meta:c={},family:u={type:"regular"},regional:d}={}){let m=te(a),f=te(u.links),p=te(u.owners),_=[];n(e,(e=>e&&$(_,e)));let g={id:K(),seq:_,next:te(i),meta:c,scope:l,family:{type:u.type||"crosslink",links:f,owners:p}};return n(f,(e=>$(U(e),g))),n(p,(e=>$(F(e),g))),n(m,(e=>$(e.next,g))),d&&Y&&ee(A(Y),[g]),g}function s(e,t,r){let a=je,s=null,o=Le;if(e.target&&(t=e.params,r=e.defer,a="page"in e?e.page:a,e.stack&&(s=e.stack),o=V(e)||o,e=e.target),o&&Le&&o!==Le&&(Le=null),Array.isArray(e))for(let n=0;n<e.length;n++)Oe("pure",a,j(e[n]),s,t[n],o);else Oe("pure",a,j(e),s,t,o);if(r&&!Ne)return;let i,l,c,u,d,m,f={isRoot:Ne,currentPage:je,scope:Le,isWatch:$e,isPure:Pe};Ne=0;e:for(;u=Ie();){let{idx:e,stack:t,type:r}=u;c=t.node,je=d=t.page,Le=V(t),d?m=d.reg:Le&&(m=Le.reg);let a=!!d,s=!!Le,o={fail:0,scope:c.scope};i=l=0;for(let n=e;n<c.seq.length&&!i;n++){let u=c.seq[n];if(u.order){let{priority:a,barrierID:s}=u.order,o=s?d?`${d.fullID}_${s}`:s:0;if(n!==e||r!==a){s?Te.has(o)||(Te.add(o),De(n,t,a,s)):De(n,t,a);continue e}s&&Te.delete(o)}switch(u.type){case"mov":{let e,n=u.data;switch(n.from){case E:e=A(t);break;case"a":case"b":e=t[n.from];break;case"value":e=n.store;break;case"store":if(m&&!m[n.store.id])if(a){let e=Me(d,n.store.id);t.page=d=e,e?m=e.reg:s?(qe(Le,n.store,0,1,n.softRead),m=Le.reg):m=void 0}else s&&qe(Le,n.store,0,1,n.softRead);e=be(m&&m[n.store.id]||n.store)}switch(n.to){case E:t.value=e;break;case"a":case"b":t[n.to]=e;break;case"store":Ae(d,Le,c,n.target).current=e}break}case"compute":let e=u.data;if(e.fn){$e="watch"===z(c,"op"),Pe=e.pure;let n=e.safe?(0,e.fn)(A(t),o.scope,t):Be(o,e.fn,t);e.filter?l=!n:t.value=n,$e=f.isWatch,Pe=f.isPure}}i=o.fail||l}if(!i){let e=A(t);n(c.next,(n=>{Oe("child",d,n,t,e,V(t))}));let r=V(t);if(r){z(c,"needFxCounter")&&Oe("child",d,r.fxCount,t,e,r),z(c,"storeChange")&&Oe("child",d,r.storeChange,t,e,r),z(c,"warnSerialize")&&Oe("child",d,r.warnSerializeNode,t,e,r);let a=r.additionalLinks[c.id];a&&n(a,(n=>{Oe("child",d,n,t,e,r)}))}}}Ne=f.isRoot,je=f.currentPage,Le=V(f)}function o(e,n="combine"){let r=n+"(",a="",s=0;return t(e,(e=>{s<25&&(null!=e&&(r+=a,r+=S(e)?J(e).fullName:e.toString()),s+=1,a=", ")})),r+")"}function i(e,t){let n,r,a=e;if(t){let a=J(t);0===e.length?(n=a.path,r=a.fullName):(n=a.path.concat([e]),r=0===a.fullName.length?e:a.fullName+"/"+e)}else n=0===e.length?[]:[e],r=e;return{shortName:a,fullName:r,path:n}}function l(e,t){let n=t?e:e[0];se(n);let r=n.or,a=n.and;if(a){let n=t?a:a[0];if(ne(n)&&"and"in n){let n=l(a,t);e=n[0],r={...r,...n[1]}}else e=a}return[e,r]}function c(e,...t){let n=Z();if(n){let r=n.handlers[e];if(r)return r(n,...t)}}function u(e,t){let n=(e,...t)=>(P(!z(n,"derived"),"call of derived event","createEvent"),P(!Pe,"unit call from pure function","operators like sample"),je?((e,t,n,r)=>{let a=je,s=null;if(t)for(s=je;s&&s.template!==t;)s=B(s);Fe(s);let o=e.create(n,r);return Fe(a),o})(n,r,e,t):n.create(e,t)),r=Z();return Object.assign(n,{graphite:a({meta:Qe("event",n,e,t),regional:1}),create:e=>(s({target:n,params:e,scope:Le}),e),watch:e=>Ye(n,e),map:e=>et(n,k,e,[he()]),filter:e=>et(n,"filter",e.fn?e:e.fn,[he(de,1)]),filterMap:e=>et(n,"filterMap",e,[he(),ve((e=>!ae(e)),1)]),prepend(e){let t=u("* → "+n.shortName,{parent:B(n)});return c("eventPrepend",j(t)),Ge(t,n,[he()],"prepend",e),Ze(n,t),t}})}function d(e,t){let o=we(e),i=u({named:"updates",derived:1});c("storeBase",o);let l=o.id,m={subscribers:new Map,updates:i,defaultState:e,stateRef:o,getState(){let e,t=o;if(je){let t=je;for(;t&&!t.reg[l];)t=B(t);t&&(e=t)}return!e&&Le&&(qe(Le,o,1),e=Le),e&&(t=e.reg[l]),be(t)},setState:e=>s({target:m,params:e,defer:1,scope:Le}),reset:(...e)=>(n(e,(e=>m.on(e,(()=>m.defaultState)))),m),on:(e,t)=>(ie(e,".on","first argument"),P(!z(m,"derived"),".on in derived store","createStore"),n(Array.isArray(e)?e:[e],(e=>{m.off(e),q(m).set(e,Xe(tt(e,m,"on",ue,t)))})),m),off(e){let t=q(m).get(e);return t&&(t(),q(m).delete(e)),m},map(e,t){let n,r;ne(e)&&(n=e,e=e.fn),P(ae(t),"second argument of store.map","updateFilter");let a=m.getState();Z()?r=null:ae(a)||(r=e(a,t));let s=d(r,{name:`${m.shortName} → *`,derived:1,and:n}),i=tt(m,s,k,ce,e);return ke(M(s),{type:k,fn:e,from:o}),M(s).noInit=1,c("storeMap",o,i),s},watch(e,t){if(!t||!S(e)){let t=Ye(m,e);return c("storeWatch",o,e)||e(m.getState()),t}return r(re(t),"second argument should be a function"),e.watch((e=>t(m.getState(),e)))}},f=Qe("store",m,t),p=m.defaultConfig.updateFilter;m.graphite=a({scope:{state:o,fn:p},node:[ve(((e,t,n)=>(n.scope&&!n.scope.reg[o.id]&&(n.b=1),e))),ye(o),ve(((e,t,{a:n,b:r})=>!ae(e)&&(e!==n||r)),1),p&&he(ce,1),pe({from:E,target:o})],child:i,meta:f,regional:1});let _=z(m,"derived"),g="ignore"===z(m,"serialize"),v=z(m,"sid");return v&&(g||H(m,"storeChange",1),o.sid=v),v||g||_||H(m,"warnSerialize",1),r(_||!ae(e),"current state can't be undefined, use null instead"),ee(m,[i]),m}function m(...e){let t,n,a;[e,a]=l(e);let s,o,i,c=e[e.length-1];if(re(c)?(n=e.slice(0,-1),t=c):n=e,1===n.length){let e=n[0];C(e)||(s=e,o=1)}if(!o&&(s=n,t)){i=1;let e=t;t=t=>e(...t)}return r(ne(s),"shape should be an object"),nt(Array.isArray(s),!i,s,a,t)}function f(){let e={};return e.req=new Promise(((t,n)=>{e.rs=t,e.rj=n})),e.req.catch((()=>{})),e}function p(e,t){let n=u(re(e)?{handler:e}:e,t),o=j(n);H(o,"op",n.kind="effect"),n.use=e=>(r(re(e),".use argument should be a function"),_.scope.handler=e,n),n.use.getCurrent=()=>_.scope.handler;let i=n.finally=u({named:"finally",derived:1}),l=n.done=i.filterMap({named:"done",fn({status:e,params:t,result:n}){if("done"===e)return{params:t,result:n}}}),c=n.fail=i.filterMap({named:"fail",fn({status:e,params:t,error:n}){if("fail"===e)return{params:t,error:n}}}),m=n.doneData=l.map({named:"doneData",fn:({result:e})=>e}),p=n.failData=c.map({named:"failData",fn:({error:e})=>e}),_=a({scope:{handlerId:z(o,"sid"),handler:n.defaultConfig.handler||(()=>r(0,`no handler used in ${n.getType()}`))},node:[ve(((e,t,n)=>{let r=t,a=r.handler;if(V(n)){let e=V(n).handlers[r.handlerId];e&&(a=e)}return e.handler=a,e}),0,1),ve((({params:e,req:t,handler:n,args:r=[e]},a,s)=>{let o=at(e,t,1,i,s),l=at(e,t,0,i,s),[c,u]=rt(n,l,r);c&&(ne(u)&&re(u.then)?u.then(o,l):o(u))}),0,1)],meta:{op:"fx",fx:"runner"}});o.scope.runner=_,$(o.seq,ve(((e,{runner:t},n)=>{let r=B(n)?{params:e,req:{rs(e){},rj(e){}}}:e;return s({target:t,params:r,defer:1,scope:V(n)}),r.params}),0,1)),n.create=e=>{let t=f(),r={params:e,req:t};if(Le){if(!$e){let e=Le;t.req.finally((()=>{Ue(e)})).catch((()=>{}))}s({target:n,params:r,scope:Le})}else s(n,r);return t.req};let g=n.inFlight=d(0,{serialize:"ignore"}).on(n,(e=>e+1)).on(i,(e=>e-1)).map({fn:e=>e,named:"inFlight"});H(i,"needFxCounter","dec"),H(n,"needFxCounter",1);let v=n.pending=g.map({fn:e=>e>0,named:"pending"});return ee(n,[i,l,c,m,p,v,g]),n}function _(e){let t;[e,t]=l(e,1);let{source:n,effect:r,mapParams:a}=e,o=p(e,t);H(o,"attached",1);let c,{runner:u}=j(o).scope,d=ve(((e,t,r)=>{let i,{params:l,req:c,handler:u}=e,d=o.finally,m=at(l,c,0,d,r),f=r.a,p=O(u),_=1;if(a?[_,i]=rt(a,m,[l,f]):i=n&&p?f:l,_){if(!p)return e.args=[f,i],1;s({target:u,params:{params:i,req:{rs:at(l,c,1,d,r),rj:m}},page:r.page,defer:1})}}),1,1);if(n){let e;C(n)?(e=n,ee(e,[o])):(e=m(n),ee(o,[e])),c=[ye(M(e)),d]}else c=[d];u.seq.splice(1,0,...c),o.use(r);let f=B(r);return f&&(Object.assign(J(o),i(o.shortName,f)),o.defaultConfig.parent=f),Ze(r,o,"effect"),o}function g(e,r){let o=a({family:{type:"domain"},regional:1}),i={history:{},graphite:o,hooks:{}};o.meta=Qe("domain",i,e,r),t({Event:u,Effect:p,Store:d,Domain:g},((e,t)=>{let r=t.toLowerCase(),a=u({named:`on${t}`});i.hooks[r]=a;let o=new Set;i.history[`${r}s`]=o,a.create=e=>(s(a,e),e),$(j(a).seq,ve(((e,t,n)=>(n.scope=null,e)))),a.watch((e=>{ee(i,[e]),o.add(e),e.ownerSet||(e.ownerSet=o),B(e)||(e.parent=i)})),ee(i,[a]),i[`onCreate${t}`]=e=>(n(o,e),a.watch(e)),i[`create${t}`]=i[r]=(t,n)=>a(e(t,{parent:i,or:n}))}));let l=B(i);return l&&t(i.hooks,((e,t)=>Ge(e,l.hooks[t]))),i}function v(e,t){ie(e,"merge","first argument");let n=u({name:o(e,"merge"),derived:1,and:t});return Ge(e,n,[],"merge"),n}function y(e,t){let a=0;return n(ot,(n=>{n in e&&(r(null!=e[n],it(t,n)),a=1)})),a}function h(...e){let t,n,r,a,[[s,o,i],c]=l(e),u=1;return ae(o)&&ne(s)&&y(s,"sample")&&(o=s.clock,i=s.fn,u=!s.greedy,a=s.filter,t=s.target,n=s.name,r=s.sid,s=s.source),lt("sample",o,s,a,t,i,n,c,u,1,0,r)}function w(...e){let[[t,n],r]=l(e);return n||(n=t,t=n.source),y(n,"guard"),lt("guard",n.clock,t,n.filter,n.target,null,n.name,r,!n.greedy,0,1)}let b="undefined"!=typeof Symbol&&Symbol.observable||"@@observable",k="map",E="stack",S=e=>(re(e)||ne(e))&&"kind"in e;const x=e=>t=>S(t)&&t.kind===e;let C=x("store"),I=x("event"),O=x("effect"),D=x("domain"),R=x("scope");var T={__proto__:null,unit:S,store:C,event:I,effect:O,domain:D,scope:R};let L=(e,t)=>e.includes(t),N=(e,t)=>{let n=e.indexOf(t);-1!==n&&e.splice(n,1)},$=(e,t)=>e.push(t),P=(e,t,n)=>!e&&console.error(`${t} is deprecated${n?`, use ${n} instead`:""}`),j=e=>e.graphite||e,U=e=>e.family.owners,F=e=>e.family.links,M=e=>e.stateRef,A=e=>e.value,q=e=>e.subscribers,B=e=>e.parent,V=e=>e.scope,z=(e,t)=>j(e).meta[t],H=(e,t,n)=>j(e).meta[t]=n,J=e=>e.compositeName;const W=()=>{let e=0;return()=>""+ ++e};let X=W(),G=W(),K=W(),Y=null,Z=()=>Y&&Y.template,Q=e=>(e&&Y&&Y.sidRoot&&(e=`${Y.sidRoot}|${e}`),e),ee=(e,t)=>{let r=j(e);n(t,(e=>{let t=j(e);"domain"!==r.family.type&&(t.family.type="crosslink"),$(U(t),r),$(F(r),t)}))},te=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(j),ne=e=>"object"==typeof e&&null!==e,re=e=>"function"==typeof e,ae=e=>void 0===e,se=e=>r(ne(e)||re(e),"expect first argument be an object");const oe=(e,t,n,a)=>r(!(!ne(e)&&!re(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${n} to be a unit (store, event or effect)${a}`);let ie=(e,t,r)=>{Array.isArray(e)?n(e,((e,n)=>oe(e,t,`${n} item of ${r}`,""))):oe(e,t,r," or array of units")},le=(e,t,r="target")=>n(te(t),(t=>P(!z(t,"derived"),`${e}: derived unit in "${r}"`,"createEvent/createStore"))),ce=(e,{fn:t},{a:n})=>t(e,n),ue=(e,{fn:t},{a:n})=>t(n,e),de=(e,{fn:t})=>t(e);const me=(e,t,n,r)=>{let a={id:G(),type:e,data:t};return n&&(a.order={priority:n},r&&(a.order.barrierID=++fe)),a};let fe=0,pe=({from:e="store",store:t,target:n,to:r=(n?"store":E),batch:a,priority:s})=>me("mov",{from:e,store:t,to:r,target:n},s,a),_e=({fn:e,batch:t,priority:n,safe:r=0,filter:a=0,pure:s=0})=>me("compute",{fn:e,safe:r,filter:a,pure:s},n,t),ge=({fn:e})=>_e({fn:e,priority:"effect"}),ve=(e,t,n)=>_e({fn:e,safe:1,filter:t,priority:n&&"effect"}),ye=(e,t,n)=>pe({store:e,to:t?E:"a",priority:n&&"sampler",batch:1}),he=(e=de,t)=>_e({fn:e,pure:1,filter:t}),we=e=>({id:G(),current:e}),be=({current:e})=>e,ke=(e,t)=>{e.before||(e.before=[]),$(e.before,t)},Ee=null;const Se=(e,t)=>{if(!e)return t;if(!t)return e;let n;return(e.v.type===t.v.type&&e.v.id>t.v.id||Re(e.v.type)>Re(t.v.type))&&(n=e,e=t,t=n),n=Se(e.r,t),e.r=e.l,e.l=n,e},xe=[];let Ce=0;for(;Ce<6;)$(xe,{first:null,last:null,size:0}),Ce+=1;const Ie=()=>{for(let e=0;e<6;e++){let t=xe[e];if(t.size>0){if(3===e||4===e){t.size-=1;let e=Ee.v;return Ee=Se(Ee.l,Ee.r),e}1===t.size&&(t.last=null);let n=t.first;return t.first=n.r,t.size-=1,n.v}}},Oe=(e,t,n,r,a,s)=>De(0,{a:null,b:null,node:n,parent:r,value:a,page:t,scope:s},e),De=(e,t,n,r=0)=>{let a=Re(n),s=xe[a],o={v:{idx:e,stack:t,type:n,id:r},l:null,r:null};3===a||4===a?Ee=Se(Ee,o):(0===s.size?s.first=o:s.last.r=o,s.last=o),s.size+=1},Re=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},Te=new Set;let Le,Ne=1,$e=0,Pe=0,je=null,Ue=e=>{Le=e},Fe=e=>{je=e};const Me=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=B(e);if(e)return e}return null};let Ae=(e,t,n,r,a)=>{let s=Me(e,r.id);return s?s.reg[r.id]:t?(qe(t,r,a),t.reg[r.id]):r},qe=(e,t,r,a,s)=>{let o=e.reg,i=t.sid;if(o[t.id])return;let l={id:t.id,current:t.current};if(i&&i in e.sidValuesMap&&!(i in e.sidIdMap))l.current=e.sidValuesMap[i];else if(t.before&&!s){let s=0,i=r||!t.noInit||a;n(t.before,(t=>{switch(t.type){case k:{let n=t.from;if(n||t.fn){n&&qe(e,n,r,a);let s=n&&o[n.id].current;i&&(l.current=t.fn?t.fn(s):s)}break}case"field":s||(s=1,l.current=Array.isArray(l.current)?[...l.current]:{...l.current}),qe(e,t.from,r,a),i&&(l.current[t.field]=o[o[t.from.id].id].current)}}))}i&&(e.sidIdMap[i]=t.id),o[t.id]=l};const Be=(e,t,n)=>{try{return t(A(n),e.scope,n)}catch(t){console.error(t),e.fail=1}};let Ve=(e,n={})=>(ne(e)&&(Ve(e.or,n),t(e,((e,t)=>{ae(e)||"or"===t||"and"===t||(n[t]=e)})),Ve(e.and,n)),n);const ze=(e,t)=>{N(e.next,t),N(U(e),t),N(F(e),t)},He=(e,t,n)=>{let r;e.next.length=0,e.seq.length=0,e.scope=null;let a=F(e);for(;r=a.pop();)ze(r,e),(t||n&&"sample"!==z(e,"op")||"crosslink"===r.family.type)&&He(r,t,"on"!==z(r,"op")&&n);for(a=U(e);r=a.pop();)ze(r,e),n&&"crosslink"===r.family.type&&He(r,t,"on"!==z(r,"op")&&n)},Je=e=>e.clear();let We=(e,{deep:t}={})=>{let n=0;if(e.ownerSet&&e.ownerSet.delete(e),C(e))Je(q(e));else if(D(e)){n=1;let t=e.history;Je(t.events),Je(t.effects),Je(t.stores),Je(t.domains)}He(j(e),!!t,n)},Xe=e=>{let t=()=>We(e);return t.unsubscribe=t,t},Ge=(e,t,n,r,s)=>a({node:n,parent:e,child:t,scope:{fn:s},meta:{op:r},family:{owners:[e,t],links:t},regional:1}),Ke=e=>{let t="forward",[{from:n,to:r},s]=l(e,1);return ie(n,t,'"from"'),ie(r,t,'"to"'),le(t,r,"to"),Xe(a({parent:n,child:r,meta:{op:t,config:s},family:{},regional:1}))},Ye=(e,t)=>(r(re(t),".watch argument should be a function"),Xe(a({scope:{fn:t},node:[ge({fn:de})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),Ze=(e,t,n="event")=>{B(e)&&B(e).hooks[n](t)},Qe=(e,t,n,r)=>{let a="domain"===e,s=X(),o=Ve({or:r,and:"string"==typeof n?{name:n}:n}),{parent:l=null,sid:c=null,named:u=null}=o,d=u||o.name||(a?"":s),m=i(d,l),f={op:t.kind=e,name:t.shortName=d,sid:t.sid=Q(c),named:u,unitId:t.id=s,serialize:o.serialize,derived:o.derived,config:o};if(t.parent=l,t.compositeName=m,t.defaultConfig=o,t.thru=e=>(P(0,"thru","js pipe"),e(t)),t.getType=()=>m.fullName,!a){t.subscribe=e=>(se(e),t.watch(re(e)?e:t=>e.next&&e.next(t))),t[b]=()=>t;let e=Z();e&&(f.nativeTemplate=e)}return f};const et=(e,t,n,r)=>{let a;ne(n)&&(a=n,n=n.fn);let s=u({name:`${e.shortName} → *`,derived:1,and:a});return Ge(e,s,r,t,n),s},tt=(e,t,n,r,a)=>{let s=M(t),o=pe({store:s,to:"a",priority:"read"});n===k&&(o.data.softRead=1);let i=[o,he(r)];return c("storeOnMap",s,i,C(e)&&M(e)),Ge(e,t,i,n,a)},nt=(e,n,a,s,i)=>{let l=e?e=>e.slice():e=>({...e}),u=e?[]:{},m=l(u),f=we(m),p=we(1);f.type=e?"list":"shape",f.noInit=1,c("combineBase",f,p);let _=d(m,{name:o(a),derived:1,and:s}),g=M(_);g.noInit=1,H(_,"isCombine",1);let v=ye(f);v.order={priority:"barrier"};let y=[ve(((e,t,n)=>(n.scope&&!n.scope.reg[f.id]&&(n.c=1),e))),v,pe({store:p,to:"b"}),ve(((e,{key:t},r)=>{if(r.c||e!==r.a[t])return n&&r.b&&(r.a=l(r.a)),r.a[t]=e,1}),1),pe({from:"a",target:f}),pe({from:"value",store:0,target:p}),pe({from:"value",store:1,target:p,priority:"barrier",batch:1}),ye(f,1),i&&he()];return t(a,((e,t)=>{if(!C(e))return r(!S(e)&&!ae(e),`combine expects a store in a field ${t}`),void(m[t]=u[t]=e);u[t]=e.defaultState,m[t]=e.getState();let n=Ge(e,_,y,"combine",i);n.scope.key=t;let a=M(e);ke(f,{type:"field",field:t,from:a}),c("combineField",a,n)})),_.defaultShape=a,ke(g,{type:k,from:f,fn:i}),Z()||(_.defaultState=i?g.current=i(m):u),_};let rt=(e,t,n)=>{try{return[1,e(...n)]}catch(e){return t(e),[0,null]}},at=(e,t,n,r,a)=>o=>s({target:[r,st],params:[n?{status:"done",params:e,result:o}:{status:"fail",params:e,error:o},{value:o,fn:n?t.rs:t.rj}],defer:1,page:a.page,scope:V(a)});const st=a({node:[ge({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}}),ot=["source","clock","target"],it=(e,t)=>e+`: ${t} should be defined`;let lt=(e,t,n,a,s,o,i,l,f,p,_,g)=>{let y=!!s;r(!ae(n)||!ae(t),it(e,"either source or clock"));let h=0;ae(n)?h=1:S(n)||(n=m(n)),ae(t)?t=n:(ie(t,e,"clock"),Array.isArray(t)&&(t=v(t))),h&&(n=t),l||i||(i=n.shortName);let w="none";(_||a)&&(S(a)?w="unit":(r(re(a),"`filter` should be function or unit"),w="fn")),s?(ie(s,e,"target"),le(e,s)):"none"===w&&p&&C(n)&&C(t)?s=d(o?o(be(M(n)),be(M(t))):be(M(n)),{name:i,sid:g,or:l}):(s=u({name:i,derived:1,or:l}),c("sampleTarget",j(s)));let b=we(),k=[];if("unit"===w){let[n,r]=ut(a,s,t,b,e);k=[...ct(r),...ct(n)]}let[x,I]=ut(n,s,t,b,e);return ee(n,[Ge(t,s,[c("sampleSourceLoader"),pe({from:E,target:b}),...ct(I),ye(x,1,f),...k,ye(b),"fn"===w&&he(((e,t,{a:n})=>a(e,n)),1),o&&he(ce),c("sampleSourceUpward",y)],e,o)]),s};const ct=e=>[ye(e),ve(((e,t,{a:n})=>n),1)],ut=(e,t,n,r,s)=>{let o=C(e),i=o?M(e):we(),l=we(o);return o||a({parent:e,node:[pe({from:E,target:i}),pe({from:"value",store:1,target:l})],family:{owners:[e,t,n],links:t},meta:{op:s},regional:1}),c("sampleSource",l,i,r),[i,l]},dt=(e,t,n,r)=>{let a=e[t];a&&s({target:a,params:Array.isArray(a)?a.map((()=>n)):n,defer:1,stack:r})};function mt(e){var{if:n,then:s,else:o,source:i=u({name:"source",sid:"epke23"},{name:"source",sid:"epke23"})}=e,d=T.unit(n)||"function"==typeof n?n:e=>e===n;return s&&o?function(...e){let n,s,o="split",[[i,d],m]=l(e),f=!d;f&&(n=i.cases,d=i.match,s=i.clock,i=i.source);let p=C(d),_=!S(d)&&re(d),g=!p&&!_&&ne(d);n||(n={}),f?t(n,((e,t)=>le(o,e,`cases.${t}`))):(r(g,"match should be an object"),t(d,((e,t)=>n[t]=u({derived:1,and:m}))),n.__=u({derived:1,and:m}));let v,y=new Set([].concat(i,s||[],Object.values(n))),h=Object.keys(p||_?n:d);if(p||_)p&&y.add(d),v=[p&&ye(M(d),0,1),_e({safe:p,filter:1,pure:!p,fn(e,t,n){let r=String(p?n.a:d(e));dt(t,L(h,r)?r:"__",e,n)}})];else if(g){let e=we({});e.type="shape";let n,r=[];t(d,((t,a)=>{if(S(t)){n=1,$(r,a),y.add(t);let s=Ge(t,[],[ye(e),ve(((e,t,{a:n})=>n[a]=e))]);if(C(t)){e.current[a]=t.getState();let n=M(t);ke(e,{from:n,field:a,type:"field"}),c("splitMatchStore",n,s)}}})),n&&c("splitBase",e),v=[n&&ye(e,0,1),he(((e,t,n)=>{for(let a=0;a<h.length;a++){let s=h[a];if(L(r,s)?n.a[s]:d[s](e))return void dt(t,s,e,n)}dt(t,"__",e,n)}),1)]}else r(0,"expect match to be unit, function or object");let w=a({meta:{op:o},parent:s?[]:i,scope:n,node:v,family:{owners:Array.from(y)},regional:1});if(s&&lt(o,s,i,null,w,null,o,m,0,0,0),!f);}({and:[{source:i,match:{then:d,else:ft(d)},cases:{then:s,else:o}}],or:{sid:"9tug3k"}}):s?w({and:[{source:i,filter:d,target:s}],or:{sid:"abznoh"}}):o&&w({and:[{source:i,filter:ft(d),target:o}],or:{sid:"-eb29qp"}}),i}function ft(e){return T.unit(e)?e.map((e=>!e)):t=>!e(t)}const pt=g({name:"root",sid:"-btr4u7"}),_t=pt.domain({name:"d",sid:"b28hef"}).event({name:"dispatchCustomEvent",sid:"-47z8bd"}),gt=pt.domain({name:"d",sid:"-vegh19"}),vt=gt.store(null,{name:"$cookieDomain",sid:"kdpvk3"}),yt=gt.event({name:"initCookieStorage",sid:"1tawct"}),ht=gt.effect({name:"writeCookieFx",sid:"-9pk9my"}),wt=gt.effect({name:"readCookieFx",sid:"e6j93v"}),bt=_({and:{source:vt,effect:ht,mapParams:(e,t)=>({...e,cookieDomain:t})},or:{name:"writeItemFx",sid:"-zaqi3a"}}),kt=_({and:{source:vt,effect:wt,mapParams:(e,t)=>({...e,cookieDomain:t})},or:{name:"readItemFx",sid:"50pqom"}}),Et=pt.domain({name:"d",sid:"-880aw3"}),St=Et.store({},{name:"$thirdPartyCookieStorage",sid:"gdllce"}),xt=Et.store(null,{name:"$thirdPartyCookieStorageParams",sid:"-5ijj5f"}),Ct=Et.store(!1,{name:"$thirdPartyCookieStorageReady",sid:"4dguzb"}),It=Et.event({name:"initThirdPartyCookieStorage",sid:"ethhb2"}),Ot=Et.event({name:"thirdPartyCookieStorageReady",sid:"kl89x5"}),Dt=Et.event({name:"pushToThirdPartyCookieStorage",sid:"tkkha7"}),Rt=pt.domain({name:"d",sid:"51jpgp"}),Tt=Rt.store(null,{name:"$userId",sid:"lv6hzj"}),Lt=Rt.store(!1,{name:"$newUser",sid:"-t9s18w"}),Nt=Rt.event({name:"onCreateUser",sid:"vj76ss"}),$t=Rt.event({name:"initUser",sid:"-ulptba"}),Pt=Rt.event({name:"changeUserId",sid:"-am5ja"}),jt=Rt.event({name:"userReady",sid:"-vbbaiu"}),Ut=Rt.event({name:"clearUser",sid:"mt8xh5"});function Ft(e){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",(()=>e())):e()}const Mt=pt.domain({name:"d",sid:"34ayxs"}),At=Mt.event({name:"initMetadata",sid:"7cxylt"}),qt=Mt.event({name:"metadataReady",sid:"co7cas"}),Bt=Mt.event({name:"eventWithMetadataReceived",sid:"mrx8i1"}),Vt=Mt.event({name:"resetMetadata",sid:"-w3i3q9"}),zt=pt.domain({name:"d",sid:"-maltjf"}),Ht=zt.event({name:"setDomEventsTrackerConfig",sid:"-phnjbc"}),Jt=zt.event({name:"resetDomEventsTrackerConfig",sid:"x9dk94"}),Wt=zt.event({name:"addEventConfigToStart",sid:"l3xmgz"}),Xt=zt.event({name:"addEventConfigToEnd",sid:"wtobkb"}),Gt=zt.event({name:"addCollectionToStart",sid:"vfwco6"}),Kt=zt.event({name:"addCollectionToEnd",sid:"m6cvxq"}),Yt=zt.event({name:"captureEvent",sid:"-d2tt9d"}),Zt=zt.event({name:"eventCaptured",sid:"-vcq7rb"}),Qt=["resize","focusin","focusout","click","dblclick","mousedown","mouseup","paste","keydown","keypress","keyup","submit","change","input"];function en(){let e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(n=>{let r=16*Math.random();return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),("x"===n?r:3&r|8).toString(16)}))}function tn(...e){const t=e.map(((e,t)=>0===t?e.trim().replace(/[\/]*$/g,""):e.trim().replace(/(^[\/]*|[\/]*$)/g,""))).filter((e=>e.length)).join("/"),n=e[e.length-1];return"/"===n[n.length-1]&&"/"!==t[t.length-1]?`${t}/`:t}function nn(e,t){const n=function(e){const t=[];for(const n in e)if(e.hasOwnProperty(n)){const r=`${encodeURIComponent(n)}=${encodeURIComponent(String(e[n]))}`;t.push(r)}return t.join("&")}(t),r=e[e.length-1];return"?"===r?`${e}${n}`:/\?|\&/.test(e)&&"&"!==r?`${e}&${n}`:`${e}?${n}`}const rn=e=>(e=>{if(!document.referrer)return!1;try{const t="."===e[0]?e.slice(1):e,n=new URL(document.referrer);return n.origin===location.origin||n.origin.endsWith(t)}catch(e){return!0}})(e)?null:document.referrer||null,an=e=>{const{externalReferrer:t,ignoreSessionDomainsList:n}=e;return!!(t&&n&&n.length)&&n.some((e=>t.includes(e)))},sn=e=>{const t=e=>null===e||"string"==typeof e;return"object"==typeof e&&t(e.utm_source)&&t(e.utm_medium)&&t(e.utm_campaign)&&t(e.utm_content)&&t(e.utm_term)&&t(e.gclid)&&t(e.yclid)&&t(e.ymclid)&&t(e.fbclid)},on=()=>{const e=function(e){const t=e.indexOf("?");let n=e.indexOf("#");if(-1==n&&-1==t)return{};-1==n&&(n=e.length);const r=-1==t||n==t+1?e.substring(n):e.substring(t+1,n),a={};return r.split("&").forEach((function(e){if(!e)return;const t=(e=e.split("+").join(" ")).indexOf("=");let n=t>-1?e.substr(0,t):e;const r=t>-1?decodeURIComponent(e.substr(t+1)):"",s=n.indexOf("[");if(-1==s)a[decodeURIComponent(n)]=r;else{const e=n.indexOf("]",s),t=decodeURIComponent(n.substring(s+1,e));n=decodeURIComponent(n.substring(0,s)),a[n]||(a[n]=[]);const o=a[n];if(!Array.isArray(o))return;t?o[+t]=r:o.push(r)}})),a}(window.location.search),t={utm_source:e.utm_source||null,utm_medium:e.utm_medium||null,utm_campaign:e.utm_campaign||null,utm_content:e.utm_content||null,utm_term:e.utm_term||null,gclid:e.gclid||null,yclid:e.yclid||null,ymclid:e.ymclid||null,fbclid:e.fbclid||null};return sn(t)?t:{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null}},ln=e=>{const t=e=>"string"==typeof e;return t(e.utm_source)||t(e.utm_medium)||t(e.utm_campaign)||t(e.utm_content)||t(e.utm_term)||t(e.gclid)||t(e.yclid)||t(e.ymclid)||t(e.fbclid)},cn=()=>bt({key:"last_event_ts",value:""+ +new Date}),un=async()=>{const e=await kt({key:"last_event_ts"}).then((({value:e})=>e));return null===e?null:+e},dn=async(e=18e5)=>{const t=await un();return!!t&&+new Date-t>e},mn=()=>bt({key:"rete_marketing_session_1_last_event_ts",value:""+ +new Date}),fn=async()=>{const e=await kt({key:"rete_marketing_session_1_last_event_ts"}).then((({value:e})=>e));return null===e?null:+e},pn=async()=>await kt({key:"rete_marketing_session_1_last_external_referrer"}).then((({value:e})=>e)),_n=async()=>{const e=await kt({key:"rete_marketing_session_1_last_utm"}).then((({value:e})=>e));if(null===e)return{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null};let t;try{t=JSON.parse(e)}catch(e){return{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null}}return sn(t)?t:{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null}},gn=async(e=18e5)=>{const t=await fn();return!!t&&+new Date-t>e},vn=()=>bt({key:"rete_marketing_session_2_last_event_ts",value:""+ +new Date}),yn=async()=>{const e=await kt({key:"rete_marketing_session_2_last_event_ts"}).then((({value:e})=>e));return null===e?null:+e},hn=async()=>{const e=await kt({key:"rete_marketing_session_2_last_utm"}).then((({value:e})=>e));if(null===e)return{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null};let t;try{t=JSON.parse(e)}catch(e){return{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null}}return sn(t)?t:{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null}},wn=e=>{try{return bt({key:"rete_marketing_session_2_last_utm",value:JSON.stringify(e)})}catch(e){}},bn=async(e=18e5)=>{const t=await yn();return!!t&&+new Date-t>e},kn=e=>bt({key:"rete-marketing-session-2-id",value:e}),En=()=>bt({key:"rete_marketing_session_3_last_event_ts",value:""+ +new Date}),Sn=async()=>{const e=await kt({key:"rete_marketing_session_3_last_event_ts"}).then((({value:e})=>e));return null===e?null:+e},xn=async()=>{const e=await kt({key:"rete_marketing_session_3_last_utm"}).then((({value:e})=>e));if(null===e)return{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null};let t;try{t=JSON.parse(e)}catch(e){return{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null}}return sn(t)?t:{utm_source:null,utm_medium:null,utm_campaign:null,utm_content:null,utm_term:null,gclid:null,yclid:null,ymclid:null,fbclid:null}},Cn=e=>{try{return bt({key:"rete_marketing_session_3_last_utm",value:JSON.stringify(e)})}catch(e){}},In=async(e=18e5)=>{const t=await Sn();return!!t&&+new Date-t>e},On=e=>bt({key:"rete-marketing-session-3-id",value:e}),Dn=pt.createDomain({name:"d",sid:"-prvgpn"}),Rn=Dn.store({baseSessions:!0,marketingSessions1:!0,marketingSessions2:!0,marketingSessions3:!0},{name:"$enabledSessions",sid:"52id4d"}),Tn=Dn.event({name:"eventCaptured",sid:"-4jcped"}),Ln=Dn.event({name:"setEnabledSessions",sid:"jla6mk"}),Nn=pt.domain({name:"d",sid:"-lfhdr5"}),$n=Nn.event({name:"initDomObservers",sid:"-b23yh6"}),Pn=Nn.event({name:"eventCaptured",sid:"c6yp0g"}),jn=(e,t)=>t&&"textContent"!==t?"string"==typeof t&&e instanceof Element?e.getAttribute(t):null:e.textContent;function Un(e,t){if("string"===e.type){const n=t||window.document;if(!e.selector)return jn(n,e.parseFrom);const r=n.querySelector(e.selector),a=r?jn(r,e.parseFrom):null;return e.formatter?e.formatter(a,r):a}if("count"===e.type)return(t||window.document).querySelectorAll(e.selector).length;if("number"===e.type){const n=t||window.document;if(!e.selector){const t=jn(n,e.parseFrom);return e.formatter(t,n)}const r=n.querySelector(e.selector),a=r?jn(r,e.parseFrom):null;return e.formatter(a,r)}if("boolean"===e.type){const n=t||window.document;let r=n.querySelector(e.selector);!r&&n instanceof Element&&(r=n.matches(e.selector)?n:null);const a=Boolean(r);return e.inverse?!a:a}if("array"===e.type){const n=(t||window.document).querySelectorAll(e.selector);if(e.items){const t=[];for(const r of n)t.push(Un(e.items,r));return t}return[...n].map((t=>jn(t,e.parseFrom)))}if("object"===e.type){const n={};for(const{key:r,value:a}of e.keys)n[r]=Un(a,t);return n}return null}const Fn={attributes:!1,childList:!0,subtree:!0,characterData:!1,characterDataOldValue:!1,attributeOldValue:!1};class Mn extends class{constructor(){this.events=[]}createUnwatcher(e,t){return()=>{for(let e=0;e<this.events.length;e++){const n=this.events[e];n.handlers=n.handlers.filter((e=>e!==t)),n.handlers.length||(this.events.splice(e,1),e--)}}}on(e,t){const n=this.createUnwatcher(e,t),r=this.events.find((t=>t.eventName===e));return r&&r.handlers.includes(t)||(r?r.handlers.push(t):this.events.push({eventName:e,handlers:[t]})),n}off(e,t){this.createUnwatcher(e,t)()}dispatch(e,t){const n=this.events.find((t=>t.eventName===e));if(n)for(const e of n.handlers)e(t)}}{constructor(e=document.body){super(),this._rootElement=e,this._mainObserver=null,this._targetElementsObservers=[],this._targetElementsDescriptors=[],this._onRootElementMutated=e=>{for(const t of e)if("childList"===t.type){for(const n of t.addedNodes)if(n instanceof window.Element)for(const t of this._targetElementsDescriptors)this._checkTargetSelectorAndObserve(t,n,e);this._clearObservedElementsByMutation(t)}}}_checkTargetSelectorAndObserve(e,t,n){const r=[...t.querySelectorAll(e.selector)];if(t.matches(e.selector)&&r.push(t),!r.length)return;this._observeTargetElements(r,e);const a=this._matchTargetElementMutations(e,n);for(const{target:t,mutations:n}of a)this._dispatchMutatedEvent(t,n,e)}_matchTargetElementMutations(e,t){const n=[];for(const r of t){if(!(r.target instanceof Element))continue;const t=r.target.closest(e.selector);if(!t)continue;const a=n.find((e=>e.target===t));a?a.mutations.push(r):n.push({target:t,mutations:[r]})}return n}_observeTargetElements(e,t){const n=this._targetElementsObservers.find((e=>e.descriptor===t)),r=n||{descriptor:t,observedElements:[]};n||this._targetElementsObservers.push(r);for(const n of e){if(r.observedElements.some((({element:e})=>e===n)))continue;const e=new window.MutationObserver((e=>this._onTargetElementMutated(n,e,t)));this._dispatchFoundEvent(t,n),e.observe(n,t.observerConfig),r.observedElements.push({element:n,observer:e})}}_onTargetElementMutated(e,t,n){this._dispatchMutatedEvent(e,t,n)}_dispatchMutatedEvent(e,t,n){const r={type:"target-element-mutated",descriptor:n,mutations:t,element:e};this.dispatch("target-element-mutated",r)}_dispatchFoundEvent(e,t){const n={type:"target-element-found",descriptor:e,element:t};this.dispatch("target-element-found",n)}_clearObservedElementsByMutation(e){if(e.removedNodes&&e.removedNodes.length){for(const{descriptor:t,observedElements:n}of this._targetElementsObservers)for(let r=0;r<n.length;r++){const{element:a,observer:s}=n[r];if([...e.removedNodes].includes(a)){const e=s.takeRecords();e.length&&this._onTargetElementMutated(a,e,t),s.disconnect(),n.splice(r,1),r--}}for(let e=0;e<this._targetElementsObservers.length;e++)this._targetElementsObservers[e].observedElements.length||(this._targetElementsObservers.splice(e,1),e--)}}_clearObservedElementsByDescriptor(e){const t=this._targetElementsObservers.findIndex((t=>t.descriptor===e));if(-1===t)return;const{observedElements:n}=this._targetElementsObservers[t];for(let t=0;t<n.length;t++){const{element:r,observer:a}=n[t],s=a.takeRecords();s.length&&this._onTargetElementMutated(r,s,e),a.disconnect(),n.splice(t,1),t--}}get observed(){return this._targetElementsObservers}start(e){return this._mainObserver=new window.MutationObserver((t=>{this._onRootElementMutated(t),e&&e(t)})),this._mainObserver.observe(this._rootElement,Fn),this}stop(){return this._mainObserver&&(this._mainObserver.disconnect(),this._onRootElementMutated(this._mainObserver.takeRecords()),this._mainObserver=null),this.stopObservation(),this}subscribe(e,t){const n=n=>{t?t.name===n.descriptor.name&&e(n):e(n)};return this.on("target-element-mutated",n),this.on("target-element-found",n),()=>{this.off("target-element-mutated",n),this.off("target-element-found",n)}}stopObservation(e){for(let t=0;t<this._targetElementsObservers.length;t++){const n=this._targetElementsObservers[t];e&&n.descriptor.name!==e||(this._clearObservedElementsByDescriptor(n.descriptor),this._targetElementsObservers.splice(t,1),t--)}if(!e)return this._targetElementsDescriptors=[],this;const t=this._targetElementsDescriptors.filter((t=>t.name!==e));return this._targetElementsDescriptors=t,this}observe(e){this._targetElementsDescriptors.push(e);const t=[...this._rootElement.querySelectorAll(e.selector)];return t.length&&this._observeTargetElements(t,e),this}}const An={attributes:!1,childList:!0,subtree:!0,characterData:!1,characterDataOldValue:!1,attributeOldValue:!1};var qn=function(e,t,n){var r=null,a=null,s=n&&n.leading,o=n&&n.trailing;null==s&&(s=!0),null==o&&(o=!s),1==s&&(o=!1);var i=function(){r&&(clearTimeout(r),r=null)},l=function(){var n=s&&!r,i=this,l=arguments;if(a=function(){return e.apply(i,l)},r||(r=setTimeout((function(){if(r=null,o)return a()}),t)),n)return n=!1,a()};return l.cancel=i,l.flush=function(){var e=a;i(),e&&e()},l};const Bn=pt.domain({name:"d",sid:"lq99jk"}),Vn=Bn.store([],{name:"$configs",sid:"5pxjhh"}),zn=Bn.store({},{name:"$lastResults",sid:"-zg8nu7"}),Hn=Bn.event({name:"onDomCollected",sid:"smlhdb"}),Jn=Bn.effect({name:"captureEventFx",sid:"xydmry"}),Wn=pt.domain({name:"d",sid:"-yfvqzo"}),Xn=Wn.event({name:"eventCaptured",sid:"-dnio0q"}),Gn=Wn.event({name:"onDomContentLoaded",sid:"-885kc2"}),Kn=Wn.event({name:"onWindowLoaded",sid:"-7luxx2"}),Yn=Wn.event({name:"onWindowUnloaded",sid:"3r50w0"}),Zn=()=>{var e;Ft((()=>Gn())),e=()=>Kn(),"complete"!=document.readyState?window.addEventListener("load",(()=>e())):e(),function(e){const t=()=>{Yn(),window.removeEventListener("unload",t)};window.addEventListener("unload",t,!1)}()},Qn=pt.domain({name:"d",sid:"-csq7er"}).event({name:"eventCaptured",sid:"-yw39h5"}),er=e=>({href:e.href,origin:e.origin,pathname:e.pathname,search:e.search}),tr=(e,t)=>e.href!==t.href,nr=pt.domain({name:"d",sid:"-ldyzu7"}).event({name:"eventCaptured",sid:"6u4fw3"}),rr=pt.event({name:"trackerInit",sid:"-eesnqa"}),ar=new Uint32Array(256);for(let e=256;e--;){let t=e;for(let e=8;e--;)t=1&t?3988292384^t>>>1:t>>>1;ar[e]=t}function sr(e,t){if(!e)return!1;const n=524309;return(function(e){let t=-1;for(let n=0,r=e.length;n<r;n++)t=t>>>8^ar[255&t^e.charCodeAt(n)];return(-1^t)>>>0}(e)>>>3)%n<t*n}const or=({userId:e,endpointName:t})=>`force_enabled_endpoint_${t}_for_user_${e}`,ir=e=>{const{forceEnabledUsers:t,event:n,userId:r,endpointName:a,endpointGuard:s}=e;let o=!1,i=!1,l=!1,c=!1,u=!1,d=!1,m=!1,f=!1,p=!1,_=!1;_=!s.filters||!s.filters.length||s.filters.every((e=>e(n))),o=!s.fraction||sr(r,s.fraction.all),"dom-event"===n.type&&s.fraction?.domEvents&&(i=sr(r,s.fraction.domEvents)),"dom-observer"===n.type&&s.fraction?.domObservers&&(l=sr(r,s.fraction.domObservers)),"document-visibility"===n.type&&s.fraction?.documentVisibiltyEvents&&(p=sr(r,s.fraction.documentVisibiltyEvents)),"page-state"===n.type&&s.fraction?.pageStateEvents&&(u=sr(r,s.fraction?.pageStateEvents)),"custom-event"===n.type&&s.fraction?.customEvents&&(d=sr(r,s.fraction?.customEvents)),"pageview"===n.type&&s.fraction?.pageviewEvents&&(m=sr(r,s.fraction?.pageviewEvents)),"session-event"===n.type&&s.fraction?.sessionEvents&&(f=sr(r,s.fraction?.sessionEvents));const g=n.endpointsOptions?.find((({name:e})=>e===a));return g&&g.fraction&&(c=sr(r,g.fraction)),{forceEnabledByUser:t.includes(r),enabledByAllEventsFraction:o,enabledByDomEventsFraction:i,enabledByDomObserversFraction:l,enabledByPageStateEventsFraction:u,enabledByPageviewEventsFraction:m,enabledBySessionEventsFraction:f,enabledByCustomEventsFraction:d,enabledByCurrentEventFraction:c,enabledByDocumentVisibilityEventsFraction:p,enabledByFilters:_}},lr=e=>{const{name:t,guard:n,transport:r}=e,a=pt.domain({name:"d",sid:"gnh1u1"}),s=a.store([],{name:"$forceEnabledUsers",sid:"y69ktn"}),o=a.event({name:"forceEnableForUser",sid:"9f7em9"}),i=_({and:{effect:bt,mapParams:e=>({key:or({userId:e,endpointName:t}),value:"1"})},or:{name:"forceEnableForUserFx",sid:"-2wiat7"}}),l=_({and:{effect:kt,mapParams:({userId:e})=>({key:or({userId:e,endpointName:t})})},or:{name:"isEndpointForceEnabledForUserFx",sid:"rg5z5i"}}),c=a.effect({handler:r},{name:"sendEventFx",sid:"2ky4x7"});s.on(o,((e,t)=>e.includes(t)?e:[...e,t])).on(l.done,((e,{params:t,result:n})=>null===n.value||e.includes(t.userId)?e:[...e,t.userId])),Ke({and:{from:o,to:i},or:{sid:"-5dtxc6"}}),h({and:[{source:Tt,clock:Bt,fn:(e,t)=>({userId:e,event:t}),target:l}],or:{sid:"-5b2ydd"}});const u=h({and:[{clock:l.done,source:s,fn:(e,{params:r})=>({forceEnabledUsers:e,event:r.event,userId:r.userId,enabledInfo:ir({forceEnabledUsers:e,endpointGuard:n,endpointName:t,event:r.event,userId:r.userId})})}],or:{name:"checkEndpoint",sid:"s30b6w"}});return w({and:[{source:u,filter:({enabledInfo:e})=>e.enabledByFilters&&(e.forceEnabledByUser||e.enabledByAllEventsFraction||e.enabledByDomEventsFraction||e.enabledByDomObserversFraction||e.enabledByPageStateEventsFraction||e.enabledByPageviewEventsFraction||e.enabledByCustomEventsFraction||e.enabledBySessionEventsFraction||e.enabledByCurrentEventFraction||e.enabledByDocumentVisibilityEventsFraction),target:c}],or:{sid:"-4asj7j"}}),{$forceEnabledUsers:s,forceEnableForUser:o}},cr=e=>bt({key:"rete-session-id",value:e}),ur=async()=>{const e=(()=>{const e=window.localStorage.getItem("last_event_ts");return null===e?null:+e})(),t=await(async()=>{const e=await kt({key:"last_event_ts"}).then((({value:e})=>e));return null===e?null:+e})(),n=window.localStorage.getItem("rete-last-external-referrer"),r=await kt({key:"rete-last-external-referrer"}).then((({value:e})=>e)),a=window.localStorage.getItem("rete-session-id"),s=await kt({key:"rete-session-id"}).then((({value:e})=>e));var o,i;"number"==typeof e&&"number"!=typeof t&&"string"==typeof n&&"string"!=typeof r&&a&&!s&&await Promise.all([(i=e,bt({key:"last_event_ts",value:`${i}`})),(o=n,bt({key:"rete-last-external-referrer",value:o})),cr(a)])},dr=e=>bt({key:"rete-marketing-session-1-id",value:e}),mr=e=>{try{return bt({key:"rete_marketing_session_1_last_utm",value:JSON.stringify(e)})}catch(e){}},fr=async()=>{const e=(()=>{const e=window.localStorage.getItem("rete_marketing_session_1_last_event_ts");return null===e?null:+e})(),t=await(async()=>{const e=await kt({key:"rete_marketing_session_1_last_event_ts"}).then((({value:e})=>e));return null===e?null:+e})(),n=window.localStorage.getItem("rete_marketing_session_1_last_external_referrer"),r=await kt({key:"rete_marketing_session_1_last_external_referrer"}).then((({value:e})=>e)),a=window.localStorage.getItem("rete-marketing-session-1-id"),s=await kt({key:"rete-marketing-session-1-id"}).then((({value:e})=>e)),o=(()=>{const e=window.localStorage.getItem("rete_marketing_session_1_last_utm");if(null===e)return null;let t;try{t=JSON.parse(e)}catch(e){return null}return(e=>{const t=e=>null===e||"string"==typeof e;return"object"==typeof e&&t(e.utm_source)&&t(e.utm_medium)&&t(e.utm_campaign)&&t(e.utm_content)&&t(e.utm_term)&&t(e.gclid)&&t(e.yclid)&&t(e.ymclid)&&t(e.fbclid)})(t)?t:null})(),i=await(async()=>{const e=await kt({key:"rete_marketing_session_1_last_utm"}).then((({value:e})=>e));if(null===e)return null;let t;try{t=JSON.parse(e)}catch(e){return null}return(e=>{const t=e=>null===e||"string"==typeof e;return"object"==typeof e&&t(e.utm_source)&&t(e.utm_medium)&&t(e.utm_campaign)&&t(e.utm_content)&&t(e.utm_term)&&t(e.gclid)&&t(e.yclid)&&t(e.ymclid)&&t(e.fbclid)})(t)?t:null})();var l,c;"number"==typeof e&&"number"!=typeof t&&"string"==typeof n&&"string"!=typeof r&&a&&!s&&o&&!i&&await Promise.all([(c=e,bt({key:"rete_marketing_session_1_last_event_ts",value:`${c}`})),(l=n,bt({key:"rete_marketing_session_1_last_external_referrer",value:l})),dr(a),mr(o)])},pr=e=>bt({key:"rete-marketing-session-2-id",value:e}),_r=e=>{try{return bt({key:"rete_marketing_session_2_last_utm",value:JSON.stringify(e)})}catch(e){}},gr=async()=>{const e=(()=>{const e=window.localStorage.getItem("rete_marketing_session_2_last_event_ts");return null===e?null:+e})(),t=await(async()=>{const e=await kt({key:"rete_marketing_session_2_last_event_ts"}).then((({value:e})=>e));return null===e?null:+e})(),n=window.localStorage.getItem("rete_marketing_session_2_last_external_referrer"),r=await kt({key:"rete_marketing_session_2_last_external_referrer"}).then((({value:e})=>e)),a=window.localStorage.getItem("rete-marketing-session-2-id"),s=await kt({key:"rete-marketing-session-2-id"}).then((({value:e})=>e)),o=(()=>{const e=window.localStorage.getItem("rete_marketing_session_2_last_utm");if(null===e)return null;let t;try{t=JSON.parse(e)}catch(e){return null}return(e=>{const t=e=>null===e||"string"==typeof e;return"object"==typeof e&&t(e.utm_source)&&t(e.utm_medium)&&t(e.utm_campaign)&&t(e.utm_content)&&t(e.utm_term)&&t(e.gclid)&&t(e.yclid)&&t(e.ymclid)&&t(e.fbclid)})(t)?t:null})(),i=await(async()=>{const e=await kt({key:"rete_marketing_session_2_last_utm"}).then((({value:e})=>e));if(null===e)return null;let t;try{t=JSON.parse(e)}catch(e){return null}return(e=>{const t=e=>null===e||"string"==typeof e;return"object"==typeof e&&t(e.utm_source)&&t(e.utm_medium)&&t(e.utm_campaign)&&t(e.utm_content)&&t(e.utm_term)&&t(e.gclid)&&t(e.yclid)&&t(e.ymclid)&&t(e.fbclid)})(t)?t:null})();var l,c;"number"==typeof e&&"number"!=typeof t&&"string"==typeof n&&"string"!=typeof r&&a&&!s&&o&&!i&&await Promise.all([(c=e,bt({key:"rete_marketing_session_2_last_event_ts",value:`${c}`})),(l=n,bt({key:"rete_marketing_session_2_last_external_referrer",value:l})),pr(a),_r(o)])},vr=e=>bt({key:"rete-marketing-session-3-id",value:e}),yr=e=>{try{return bt({key:"rete_marketing_session_3_last_utm",value:JSON.stringify(e)})}catch(e){}},hr=async()=>{const e=(()=>{const e=window.localStorage.getItem("rete_marketing_session_3_last_event_ts");return null===e?null:+e})(),t=await(async()=>{const e=await kt({key:"rete_marketing_session_3_last_event_ts"}).then((({value:e})=>e));return null===e?null:+e})(),n=window.localStorage.getItem("rete_marketing_session_3_last_external_referrer"),r=await kt({key:"rete_marketing_session_3_last_external_referrer"}).then((({value:e})=>e)),a=window.localStorage.getItem("rete-marketing-session-3-id"),s=await kt({key:"rete-marketing-session-3-id"}).then((({value:e})=>e)),o=(()=>{const e=window.localStorage.getItem("rete_marketing_session_3_last_utm");if(null===e)return null;let t;try{t=JSON.parse(e)}catch(e){return null}return(e=>{const t=e=>null===e||"string"==typeof e;return"object"==typeof e&&t(e.utm_source)&&t(e.utm_medium)&&t(e.utm_campaign)&&t(e.utm_content)&&t(e.utm_term)&&t(e.gclid)&&t(e.yclid)&&t(e.ymclid)&&t(e.fbclid)})(t)?t:null})(),i=await(async()=>{const e=await kt({key:"rete_marketing_session_3_last_utm"}).then((({value:e})=>e));if(null===e)return null;let t;try{t=JSON.parse(e)}catch(e){return null}return(e=>{const t=e=>null===e||"string"==typeof e;return"object"==typeof e&&t(e.utm_source)&&t(e.utm_medium)&&t(e.utm_campaign)&&t(e.utm_content)&&t(e.utm_term)&&t(e.gclid)&&t(e.yclid)&&t(e.ymclid)&&t(e.fbclid)})(t)?t:null})();var l,c;"number"==typeof e&&"number"!=typeof t&&"string"==typeof n&&"string"!=typeof r&&a&&!s&&o&&!i&&await Promise.all([(c=e,bt({key:"rete_marketing_session_3_last_event_ts",value:`${c}`})),(l=n,bt({key:"rete_marketing_session_3_last_external_referrer",value:l})),vr(a),yr(o)])},wr=_({and:{effect:kt,mapParams:e=>({key:"user-id"})},or:{name:"getCurrentUserIdFx",sid:"azzuca"}}),br=_({and:{effect:bt,mapParams:e=>({key:"user-id",value:e})},or:{name:"writeUserIdFx",sid:"glvdlk"}}),kr=e=>`user_${e}_event_index`,Er=_({and:{effect:bt,mapParams:({userId:e,index:t})=>({key:kr(e),value:`${t}`})},or:{name:"writeUserEventIndexFx",sid:"-7o0o77"}}),Sr=async()=>{const e=(()=>{const e=(e=>{const t=document.cookie.match(new RegExp(`(?:^|; )${"reuserid".replace(/([.$?*|{}()[\]\\/+^])/g,"\\$1")}=([^;]*)`));return t?decodeURIComponent(t[1]):null})();return e||null})(),{value:t}=await wr();if("string"==typeof e&&"string"!=typeof t){await br(e);const t=(e=>{try{const t=window.localStorage.getItem("rete-users-events-stats");if(null===t)return null;const n=JSON.parse(t);return((e,t=!1)=>!("object"!=typeof e||Array.isArray(e)||!Boolean(e))&&(!!t||Object.getOwnPropertyNames(e).every((t=>(e=>{const t="object"==typeof e,n="number"==typeof e.allEventsCount,r="object"==typeof e.events;return!!(t&&n&&r)&&Object.getOwnPropertyNames(e.events).every((t=>{const n=e.events[t];return"number"==typeof n&&!window.isNaN(n)&&window.isFinite(n)}))})(e[t])))))(n)&&n[e]||null}catch{return null}})(e);t&&"number"==typeof t.allEventsCount&&await Er({userId:e,index:t.allEventsCount}),await Promise.all([ur(),fr(),gr(),hr()])}},xr={name:"defaultCollection",rootSelector:"body",sendValue:"hashOfValue",events:[{selector:"button",sendValue:"plainValue"},{selector:"a",name:"link_click",sendValue:"plainValue"},{selector:"a",name:"link_rightclick",eventType:"contextmenu",sendValue:"plainValue"},{selector:"input",sendValue:"hashOfValue"},{selector:"input",eventType:"change",sendValue:"hashOfValue"},{selector:"textarea",sendValue:"hashOfValue"},{selector:"textarea",eventType:"change",sendValue:"hashOfValue"},{selector:"select",sendValue:"plainValue"},{selector:"select",eventType:"change",sendValue:"plainValue"},{selector:"form",eventType:"submit",sendValue:"plainValue"},{selector:"*",eventType:"click",name:"something_clicked",eventCustomName:"something_clicked",sendValue:"plainValue"}]},Cr=_t.prepend((()=>({type:"custom-event",name:"tracker_created",data:{}}))),Ir=_t.prepend((()=>({type:"custom-event",name:"new_user",data:{}})));w({and:[{clock:Cr,filter:Lt,target:Ir}],or:{sid:"-x38hp3"}});class Or extends Error{constructor(e,t){if(super(e),"function"==typeof Error.captureStackTrace)Error.captureStackTrace(this,this.constructor);else{const t=new Error(e);this.stack=t.stack}this.response=t}}class Dr{isSuccessHttpStatus(e){return e>=200&&e<300}parseResponse(e){try{const t=e.responseText,n=e.getResponseHeader("Content-Type");return n&&/json/.test(n.toLowerCase())?JSON.parse(t):e.response}catch{return null}}createResponse(e){return{status:e.status,data:this.parseResponse(e)}}createHttpError(e){return new Or("http error",this.createResponse(e))}promisifyXhrResponse(e){return new Promise(((t,n)=>{e.onreadystatechange=()=>{e.readyState==e.DONE&&(this.isSuccessHttpStatus(e.status)?t(this.createResponse(e)):n(this.createHttpError(e)))}}))}constructor({baseURL:e="/"}={baseURL:"/"}){this.baseURL=e}get(e,t={}){const n=new XMLHttpRequest;let r=tn(t.baseURL||this.baseURL,e);return t.query&&(r=nn(r,t.query)),n.open("GET",r,!0),t.withCredentials&&(n.withCredentials=!0),n.send(),this.promisifyXhrResponse(n)}post(e,t={}){const n=new XMLHttpRequest;let r=tn(t.baseURL||this.baseURL,e);return t.query&&(r=nn(r,t.query)),n.open("POST",r,!0),t.withCredentials&&(n.withCredentials=!0),t.json&&n.setRequestHeader("Content-type","application/json; charset=utf-8"),n.send(t.json?JSON.stringify(t.json):t.text),this.promisifyXhrResponse(n)}}function Rr(e,t=500,n){return function(e,t=500,n){const r=Date.now();return new Promise((a=>{const s=()=>{if(e())return a(!0);const o=Date.now()-r;"number"!=typeof n||o<n?setTimeout(s,t):a(!1)};s()}))}((()=>null!==Tr(e)),t,n).then((t=>t?Tr(e):null))}function Tr(e){const t=document.cookie.match(new RegExp(`(?:^|; )${e.replace(/([.$?*|{}()[\]\\/+^])/g,"\\$1")}=([^;]*)`));return t?decodeURIComponent(t[1]):null}function Lr({name:e,value:t,domain:n,secure:r=!1,sameSite:a="Lax",expDate:s}){const o=new Date;o.setFullYear(o.getFullYear()+10);let i=`${e}=${t};expires=${(s||o).toUTCString()};domain=${n};path=/;SameSite=${a}`;r&&(i+=";secure"),document.cookie=i}function Nr({name:e,domain:t,secure:n,sameSite:r}){const a=new Date;a.setFullYear(2005),Lr({name:e,domain:t,value:"",secure:n,sameSite:r,expDate:a})}const $r=()=>{try{return Boolean(window.dataLayer&&"function"==typeof window.dataLayer.find&&window.dataLayer.some((e=>Boolean(e["gtm.start"]))))}catch(e){return!1}},Pr=g({name:"gaDataLayerDomain",sid:"-94flrf"}).event({name:"onGaDataLayerEvent",sid:"9u1cdz"}),jr=pt.domain({name:"d",sid:"-e9zts2"});jr.store([],{name:"$events",sid:"o9gghf"});const Ur=jr.store(null,{name:"$domEventsTrackerConfig",sid:"vsv39v"}),Fr=jr.effect({name:"captureEventFx",sid:"9xw1oe"}),Mr=(e,t)=>!t||("string"==typeof t?-1!==e.indexOf(t):"function"==typeof t?t(e):t.test(e)),Ar=(e,t=window)=>{const n=t.HTMLInputElement;let r=e.tagName.toLowerCase();e.id&&(r+=`#${e.id}`);const a=e.getAttribute("class");a&&a.trim()&&(r+=`.${a.trim().split(/\s+/).join(".")}`),e instanceof n&&(r+=`[type="${e.type}"]`);const s=(e=>"string"==typeof e.name?e.name:null)(e);return s&&(r+=`[name="${s}"]`),r},qr=(e,t=[])=>{if(t.unshift(e),"HTML"===e.tagName)return t;const n=e.parentElement;return n?qr(n,t):t};let Br=(e,t)=>e+t&4294967295;function Vr(e,t,n,r,a,s){return t=Br(Br(t,e),Br(r,s)),Br(t<<a|t>>>32-a,n)}function zr(e,t,n,r,a,s,o){return Vr(t&n|~t&r,e,t,a,s,o)}function Hr(e,t,n,r,a,s,o){return Vr(t&r|n&~r,e,t,a,s,o)}function Jr(e,t,n,r,a,s,o){return Vr(t^n^r,e,t,a,s,o)}function Wr(e,t,n,r,a,s,o){return Vr(n^(t|~r),e,t,a,s,o)}function Xr(e,t){let n=e[0],r=e[1],a=e[2],s=e[3];n=zr(n,r,a,s,t[0],7,-680876936),s=zr(s,n,r,a,t[1],12,-389564586),a=zr(a,s,n,r,t[2],17,606105819),r=zr(r,a,s,n,t[3],22,-1044525330),n=zr(n,r,a,s,t[4],7,-176418897),s=zr(s,n,r,a,t[5],12,1200080426),a=zr(a,s,n,r,t[6],17,-1473231341),r=zr(r,a,s,n,t[7],22,-45705983),n=zr(n,r,a,s,t[8],7,1770035416),s=zr(s,n,r,a,t[9],12,-1958414417),a=zr(a,s,n,r,t[10],17,-42063),r=zr(r,a,s,n,t[11],22,-1990404162),n=zr(n,r,a,s,t[12],7,1804603682),s=zr(s,n,r,a,t[13],12,-40341101),a=zr(a,s,n,r,t[14],17,-1502002290),r=zr(r,a,s,n,t[15],22,1236535329),n=Hr(n,r,a,s,t[1],5,-165796510),s=Hr(s,n,r,a,t[6],9,-1069501632),a=Hr(a,s,n,r,t[11],14,643717713),r=Hr(r,a,s,n,t[0],20,-373897302),n=Hr(n,r,a,s,t[5],5,-701558691),s=Hr(s,n,r,a,t[10],9,38016083),a=Hr(a,s,n,r,t[15],14,-660478335),r=Hr(r,a,s,n,t[4],20,-405537848),n=Hr(n,r,a,s,t[9],5,568446438),s=Hr(s,n,r,a,t[14],9,-1019803690),a=Hr(a,s,n,r,t[3],14,-187363961),r=Hr(r,a,s,n,t[8],20,1163531501),n=Hr(n,r,a,s,t[13],5,-1444681467),s=Hr(s,n,r,a,t[2],9,-51403784),a=Hr(a,s,n,r,t[7],14,1735328473),r=Hr(r,a,s,n,t[12],20,-1926607734),n=Jr(n,r,a,s,t[5],4,-378558),s=Jr(s,n,r,a,t[8],11,-2022574463),a=Jr(a,s,n,r,t[11],16,1839030562),r=Jr(r,a,s,n,t[14],23,-35309556),n=Jr(n,r,a,s,t[1],4,-1530992060),s=Jr(s,n,r,a,t[4],11,1272893353),a=Jr(a,s,n,r,t[7],16,-155497632),r=Jr(r,a,s,n,t[10],23,-1094730640),n=Jr(n,r,a,s,t[13],4,681279174),s=Jr(s,n,r,a,t[0],11,-358537222),a=Jr(a,s,n,r,t[3],16,-722521979),r=Jr(r,a,s,n,t[6],23,76029189),n=Jr(n,r,a,s,t[9],4,-640364487),s=Jr(s,n,r,a,t[12],11,-421815835),a=Jr(a,s,n,r,t[15],16,530742520),r=Jr(r,a,s,n,t[2],23,-995338651),n=Wr(n,r,a,s,t[0],6,-198630844),s=Wr(s,n,r,a,t[7],10,1126891415),a=Wr(a,s,n,r,t[14],15,-1416354905),r=Wr(r,a,s,n,t[5],21,-57434055),n=Wr(n,r,a,s,t[12],6,1700485571),s=Wr(s,n,r,a,t[3],10,-1894986606),a=Wr(a,s,n,r,t[10],15,-1051523),r=Wr(r,a,s,n,t[1],21,-2054922799),n=Wr(n,r,a,s,t[8],6,1873313359),s=Wr(s,n,r,a,t[15],10,-30611744),a=Wr(a,s,n,r,t[6],15,-1560198380),r=Wr(r,a,s,n,t[13],21,1309151649),n=Wr(n,r,a,s,t[4],6,-145523070),s=Wr(s,n,r,a,t[11],10,-1120210379),a=Wr(a,s,n,r,t[2],15,718787259),r=Wr(r,a,s,n,t[9],21,-343485551),e[0]=Br(n,e[0]),e[1]=Br(r,e[1]),e[2]=Br(a,e[2]),e[3]=Br(s,e[3])}const Gr=[];function Kr(e){for(let t=0;t<64;t+=4)Gr[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return Gr}function Yr(e){let t="";for(let n=0;n<4;n++)t+="0123456789abcdef"[e>>8*n+4&15]+"0123456789abcdef"[e>>8*n&15];return t}function Zr(e){return function(e){const t=[];for(let n=0;n<e.length;n++)t.push(Yr(e[n]));return t.join("")}(function(e){const t=e.length,n=[1732584193,-271733879,-1732584194,271733878];let r;for(r=64;r<=e.length;r+=64)Xr(n,Kr(e.substring(r-64,r)));e=e.substring(r-64);const a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<e.length;r++)a[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(a[r>>2]|=128<<(r%4<<3),r>55)for(Xr(n,a),r=0;r<16;r++)a[r]=0;return a[14]=8*t,Xr(n,a),n}(e))}function Qr(e){const t=[];try{!function e(n){const r=n.constructor.name;t.push(r),"Function"!==r&&"Object"!==r&&e(Object.getPrototypeOf(n))}(Object.getPrototypeOf(e))}catch(e){return[]}return t}function ea(e,t=!1){const n=e instanceof HTMLElement;return t?n||function(e){if(e instanceof HTMLElement)return!1;const t=Qr(e).reverse();return"Object"===t[0]&&"EventTarget"===t[1]&&"Node"===t[2]&&"Element"===t[3]&&"HTMLElement"===t[4]}(e):n}"5d41402abc4b2a76b9719d911017c592"!=Zr("hello")&&(Br=(e,t)=>{const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n});const ta=({event:e,eventConfig:t})=>{const n=(e=>e&&"string"==typeof e.textContent?e.textContent:null)(e.target),{pageFilter:r,textContentFilter:a,selector:s,exclude:o}=t;if(t.eventType&&e.type!==t.eventType)return!1;if(!t.eventType&&"click"!==e.type)return!1;if(!Mr(window.location.href,r))return!1;if(n&&!Mr(n.toLowerCase(),a))return!1;if(!function(e,t=!1){const n=e instanceof Element;return t?n||function(e){if(e instanceof Element)return!1;const t=Qr(e).reverse();return"Object"===t[0]&&"EventTarget"===t[1]&&"Node"===t[2]&&"Element"===t[3]}(e):n}(e.target,!0))return!1;const i=e.target;return(!o||!i.matches(o))&&Boolean(i.closest(s))},na=({event:e,collection:t})=>{for(const n of t.events)if(ta({event:e,eventConfig:n}))return n;return null};var ra;!function(e){e.LINK="link",e.BUTTON="button",e.TEXT="text",e.CHECKBOX="checkbox",e.RADIO="radio",e.NUMBER="number",e.SELECT="select",e.FORM="form",e.OTHER="other"}(ra||(ra={}));const aa=e=>"A"===e.tagName?ra.LINK:"BUTTON"===e.tagName?ra.BUTTON:"SELECT"===e.tagName?ra.SELECT:"FORM"===e.tagName?ra.FORM:"TEXTAREA"===e.tagName?ra.TEXT:Qr(e).includes("HTMLInputElement")?"checkbox"===e.type?ra.CHECKBOX:"radio"===e.type?ra.RADIO:"number"===e.type?ra.NUMBER:ra.TEXT:ra.OTHER,sa=({event:e,eventConfig:t,collection:n})=>{const r=t.sendValue||n.sendValue,a=e.target,s=(({event:e,eventConfig:t})=>{if(t.name)return t.name;const n=e.target;return`${function(e,t=!1){const n=e instanceof HTMLInputElement;return t?n||function(e){if(e instanceof HTMLElement)return!1;const t=Qr(e).reverse();return"Object"===t[0]&&"EventTarget"===t[1]&&"Node"===t[2]&&"Element"===t[3]&&"HTMLElement"===t[4]&&"HTMLInputElement"===t[5]}(e):n}(n,!0)?n.type:t.selector.replace(/[^a-zA-Z_-]/g,"")}_${e.type||t.eventType||"click"}`})({event:e,eventConfig:t}),o=(({element:e,eventConfig:t})=>{const n=ea(e,!0)?e.dataset:null;return n&&n.reteEventCustomName?n.reteEventCustomName:t.eventCustomName})({element:a,eventConfig:t}),i=(({element:e,sendValue:t,eventConfig:n})=>{const r=aa(e);let a;if("none"===t)return"";switch(r){case ra.TEXT:case ra.NUMBER:case ra.SELECT:a=e.value;break;case ra.CHECKBOX:case ra.RADIO:{const t=e.parentElement,n=t?t.textContent:null,r=e.checked?"on":"off";a=n?`${r}:${n.trim()}`:r;break}default:a=e.textContent||""}return"hashOfValue"===t?Zr(a):a})({element:a,sendValue:r,eventConfig:t}),l=((e,t=document,n=window)=>{const r=((e,t=window)=>{const n=[];let r=e;for(;r&&r!==document.body;)n.unshift(Ar(r,t)),r=r.parentElement;return n.join(" > ")})(e,n);let a;try{a=t.querySelectorAll(r)}catch(e){return}if(a.length<2)return r;{let t=null;for(let n=0;n<a.length;n++)a[n]===e&&(t=n);return t?`${r} | [${t+1}/${a.length}]`:r}})(a),c=(e=>qr(e).map((e=>{const t=e.getAttribute("class");return e.classList.length&&t?`.${t.trim().split(/\s+/).join(".")}`:e.tagName.toLocaleLowerCase()})).join(" > "))(a);return{type:"dom-event",name:s,data:{eventName:s,eventCustomName:o,nextLocation:(e=>{const t=aa(e);return t===ra.LINK?e.href:t===ra.FORM?e.action:void 0})(a),eventValue:i,eventTrigger:l,extensiveEventTrigger:c,eventConfig:t,domInfo:(({domInfoConfig:e,targetElement:t})=>{if(!e)return;const n=e.closestSelector?t.closest(e.closestSelector):document.body;return n&&ea(n,!0)?Un(e.parseConfig,n):null})({domInfoConfig:t.domInfo,targetElement:a})},endpointsOptions:t.endpointOptions}};Ur.on(Ht,((e,t)=>t)).on(Wt,((e,{collectionName:t,eventConfig:n})=>e?(e.collections=e.collections.map((e=>(e.name!==t||(e.events=[n,...e.events]),e))),{...e}):e)).on(Xt,((e,{collectionName:t,eventConfig:n})=>e?(e.collections=e.collections.map((e=>(e.name!==t||(e.events=[...e.events,n]),e))),{...e}):e)).on(Gt,((e,t)=>e?(e.collections=[t,...e.collections],{...e}):e)).on(Kt,((e,t)=>e?(e.collections=[...e.collections,t],{...e}):e)).reset(Jt),w({and:[{source:h({and:[{source:Ur,clock:Yt,fn:(e,{event:t,root:n})=>({config:e,event:t,root:n})}],or:{name:"source",sid:"-oweth8"}}),filter:({config:e})=>null!==e,target:Fr}],or:{sid:"hps6j"}}),Ke({and:{from:Fr.doneData,to:Zt},or:{sid:"12lyq9"}}),Fr.use((({event:e,root:t,config:n})=>{const r=n.collections.filter((({rootSelector:e="body"})=>t.matches(e)));for(const t of r){const n=na({event:e,collection:t});if(n)return sa({event:e,collection:t,eventConfig:n})}throw new Error("event config not found!")})),zn.on(Jn.doneData,((e,{config:t,duplicate:n,serializedResult:r})=>{if(Boolean("object"==typeof t.params&&t.params.disableDuplicateChecking)||!n){const n={...e};return n[t.config.name]=r,n}return e})),Vn.on($n,((e,t)=>t)),h({and:[{source:m({and:[{configs:Vn,lastResults:zn}],or:{name:"source",sid:"-jc3v35"}}),clock:Hn,fn:({configs:e,lastResults:t},n)=>({configs:e,lastResults:t,domCollectedPayload:n}),target:Jn}],or:{sid:"-ms9u2i"}}),w({and:[{source:Jn.doneData,filter:({config:e,url:t,duplicate:n,parseResult:r})=>{const{params:a}=e;return(!a?.doNotSendEmptyResults||null!==r)&&(!!Mr(t,e.params?.pageFilter)&&(Boolean("object"==typeof e.params&&e.params.disableDuplicateChecking)||!n))},target:Pn.prepend((({event:e})=>e))}],or:{sid:"-m911av"}}),Jn.use((({configs:e,lastResults:t,domCollectedPayload:n})=>{const r=e.find((({config:e})=>e.name===n.name));if(!r)throw new Error("dom observer config not found!");const a=t[r.config.name],s=window.location.href,o="object"==typeof(i=n.parseResult)?JSON.stringify(i):String(i);var i;const l=a===o;return{event:{name:r.config.name,type:"dom-observer",data:n.parseResult,endpointsOptions:r.endpointOptions},config:r,url:s,duplicate:l,serializedResult:o,parseResult:n.parseResult}}));const oa=pt.domain({name:"d",sid:"-qxlhbg"}).effect({name:"getPerfInfoFx",sid:"t2zgv0"});Ke({and:{from:Gn,to:oa.prepend((()=>({pageStage:"dom_content_loaded"})))},or:{sid:"-y9gxq8"}}),Ke({and:{from:Kn,to:oa.prepend((()=>({pageStage:"window_loaded"})))},or:{sid:"-xu2p44"}}),Ke({and:{from:oa.doneData.map((({pageStage:e,perfInfo:t})=>({name:e,type:"page-state",data:{stage:e,perfInfo:t}}))),to:Xn},or:{sid:"-xq84yl"}}),Ke({and:{from:Yn,to:Xn.prepend((()=>({name:"window_unloaded",type:"page-state",data:{stage:"window_unloaded"}})))},or:{sid:"-wuc2jn"}}),oa.use((({pageStage:e})=>{try{return{pageStage:e,perfInfo:function(){const e={},t=performance;if(t){const n=t.navigation;if(n){e.redirect_count=n.redirectCount+1;const t=n.type;switch(t){case PerformanceNavigation.TYPE_NAVIGATE:e.navigation_type="Navigation";break;case PerformanceNavigation.TYPE_RELOAD:e.navigation_type="Reload";break;case PerformanceNavigation.TYPE_BACK_FORWARD:e.navigation_type="History";break;default:e.navigation_type=`Unknown_${t}`}}const r=t.memory;r&&(e.used_js_heap_size=Math.floor(r.usedJSHeapSize/1048576)+1,e.total_js_heap_size=Math.floor(r.totalJSHeapSize/1048576)+1,e.js_heap_size_limit=Math.floor(r.jsHeapSizeLimit/1048576)+1);const a=t.timing;a&&(e.pre_fetch_delay=a.fetchStart-a.navigationStart+1,e.domain_lookup_delay=a.domainLookupEnd-a.domainLookupStart+1,e.connect_delay=a.connectEnd-a.connectStart+1,e.request_delay=a.responseEnd-a.requestStart+1,a.domInteractive&&(e.dom_interactive_delay=a.domInteractive-a.domLoading+1),a.domComplete&&(e.dom_complete_delay=a.domComplete-a.domLoading+1),a.loadEventEnd&&(e.window_loaded_delay=a.loadEventEnd-a.domLoading+1),a.domContentLoadedEventEnd&&(e.dom_content_loaded_listeners_delay=a.domContentLoadedEventEnd-a.domContentLoadedEventStart+1))}return e}()}}catch(t){return{pageStage:e}}}));const ia=pt.domain({name:"d",sid:"-912dmk"}).event({name:"setUserId",sid:"pn437d"}),la=_({and:{effect:kt,mapParams:e=>({key:"user-id"})},or:{name:"getCurrentUserIdFx",sid:"qj3npp"}}),ca=_({and:{effect:bt,mapParams:e=>({key:"user-id",value:"10000000-1000-4000-8000-100000000000".replace(/[10]/g,(e=>(0|16*Math.random()).toString(16)))})},or:{name:"createUserIdFx",sid:"iollc4"}}),ua=_({and:{effect:bt,mapParams:e=>({key:"user-id",value:e})},or:{name:"writeUserIdFx",sid:"-rmn4qq"}}),da=_({and:{effect:bt,mapParams:e=>({key:"user-id",value:null})},or:{name:"clearUserIdFx",sid:"-j4d14g"}});Tt.on(ia,((e,t)=>t)).reset(da),Lt.on(Nt,(()=>!0)),mt({source:$t,if:e=>Boolean(e),then:ia,else:la}),mt({source:la.doneData.map((({value:e})=>e)),if:e=>null!==e,then:ia,else:ca}),Ke({and:{from:ca.doneData.map((({value:e})=>e)),to:ia},or:{sid:"at4t7r"}}),Ke({and:{from:h({and:[{source:Tt,clock:ca.done}],or:{name:"from",sid:"p58znz"}}),to:Nt},or:{sid:"avvs6k"}}),Ke({and:{from:h({and:[{source:Tt,clock:ia}],or:{name:"from",sid:"pl70vg"}}),to:jt},or:{sid:"bbtte1"}}),Ke({and:{from:Ut,to:da},or:{sid:"brruli"}}),Ke({and:{from:Pt,to:ua},or:{sid:"buitkb"}}),Ke({and:{from:ua.doneData.map((({value:e})=>e)),to:ia},or:{sid:"c8tgzp"}});const ma=e=>`user_${e}_event_index`,fa=pt.domain({name:"d",sid:"-belevs"}),pa=fa.store(0,{name:"$windowEventIndex",sid:"euwtlg"}),_a=fa.store(en(),{name:"$windowId",sid:"-9l5vv1"}),ga=_({and:{source:m({and:[{userId:Tt}],or:{name:"source",sid:"-1na7cp"}}),effect:bt,mapParams:(e,{userId:t})=>({key:ma(t),value:e=>{if(null===e)return String(1);const t=parseInt(e,10);return isNaN(t)?String(1):String(t+1)}})},or:{name:"incUserEventIndexFx",sid:"3s5nq5"}}),va=fa.effect({name:"getWindowMetadataFx",sid:"pqsedp"}),ya=v([Zt,Pn,Xn,_t,Tn,Qn,nr],{name:"eventCaptured",sid:"-tjcb6f"}),ha=e=>{if(null===e)return 0;const t=parseInt(e);return isNaN(t)?0:t};pa.on(ya,(e=>e+1)).reset(Vt),_a.reset(Vt),Ke({and:{from:At,to:qt},or:{sid:"iv0v3w"}}),Ke({and:{from:ya.map((e=>({event:e}))),to:ga},or:{sid:"iyvf9f"}}),h({and:[{source:Rn,clock:ga.done.map((({params:e,result:t})=>({event:e.event,userEventIndex:ha(t.value)}))),fn:(e,{event:t,userEventIndex:n})=>({enabledSessions:e,event:t,userEventIndex:n}),target:va}],or:{sid:"jd62ot"}}),h({and:[{source:m({and:[{userId:Tt,windowId:_a,windowEventIndex:pa}],or:{name:"source",sid:"-xaui8i"}}),clock:va.doneData,fn:(e,{event:t,userEventIndex:n,windowMetadata:r})=>({...t,metadata:{...r,...e,userEventIndex:n}}),target:Bt}],or:{sid:"jwyo1t"}}),va.use((async({event:e,userEventIndex:t,enabledSessions:n})=>{const r=await(async e=>{const[t,n,r,a]=await Promise.all([e.baseSessions?kt({key:"rete-session-id"}).then((({value:e})=>e)):Promise.resolve(null),e.marketingSessions1?kt({key:"rete-marketing-session-1-id"}).then((({value:e})=>e)):Promise.resolve(null),e.marketingSessions2?kt({key:"rete-marketing-session-2-id"}).then((({value:e})=>e)):Promise.resolve(null),e.marketingSessions3?kt({key:"rete-marketing-session-3-id"}).then((({value:e})=>e)):Promise.resolve(null)]);return{baseSessionId:t||void 0,marketingSession1Id:n||void 0,marketingSession2Id:r||void 0,marketingSession3Id:a||void 0}})(n);return{event:e,userEventIndex:t,windowMetadata:{currentUrl:document.URL,userAgent:window.navigator.userAgent,title:document.title||"",...r}}})),vt.on(yt,((e,{cookieDomain:t})=>t));const wa=({key:e,cookieDomain:t})=>`rete_${e}_${t}`;ht.use((({key:e,value:t,cookieDomain:n})=>{const r=wa({key:e,cookieDomain:n});if("string"==typeof t&&Lr({name:r,value:t,domain:n}),"function"==typeof t){const a=t(Tr(r));return"string"==typeof a?Lr({name:r,value:a,domain:n}):Nr({name:r,domain:n}),{key:e,value:a}}return null===t&&Nr({name:r,domain:n}),{key:e,value:t}})),wt.use((({key:e,cookieDomain:t,validator:n})=>{const r=wa({key:e,cookieDomain:t}),a=Tr(r);return{key:r,value:!n||null===a||n(a)?a:null}})),Rn.on(Ln,((e,t)=>({...e,...t})));const ba=pt.domain({name:"d",sid:"4i8s1f"}),ka=ba.effect({name:"initThirdPartyCookieStorageFx",sid:"assv40"}),Ea=ba.effect({name:"pushToThirdPartyCookieStorageFx",sid:"hz0m54"});Ct.on(Ot,(()=>!0)),St.on(ka.doneData,((e,t)=>t)).on(Ea.doneData,((e,t)=>t)),xt.on(ka.done,((e,{params:t})=>t)),Ke({and:{from:It,to:ka},or:{sid:"-tjuzks"}}),h({and:[{source:St,clock:ka.doneData,target:Ot}],or:{sid:"-t5kc5e"}});const Sa=w({and:[h({and:[{source:xt,clock:Dt,fn:(e,t)=>({updateSet:t,params:e})}],or:{name:"and",sid:"zgzer3"}}),{filter:e=>Boolean(e.params)}],or:{name:"push",sid:"-w4kea3"}});Ke({and:{from:Sa,to:Ea},or:{sid:"-s7h3d0"}}),ka.use((async({baseURL:e,getStorageURL:t})=>{const n=new Dr({baseURL:e}),{data:r}=await n.get(t,{withCredentials:!0});return r})),Ea.use((async({updateSet:e,params:t})=>{const n=new Dr({baseURL:t.baseURL}),{data:r}=await n.post(t.setStorageURL,{json:e,withCredentials:!0});return r}));var xa=["tracker_created","new_user","yandex_user_id_from_ga","yandex_user_id_from_event_action_ga"],Ca="https://ftrack-1.server.retentioneering.com/endpoint",Ia={userIdProvider:(({baseURL:e,path:t})=>async()=>{const{value:n}=await kt({key:"server-id-received"});if("true"===n){const{value:e}=await kt({key:"user-id"});if(e)return e;throw new Error("existing id not found!")}const{value:r}=await kt({key:"user-id"}),a=r?{userid:r}:void 0,s=new Dr({baseURL:e}),o=await s.get(t,{query:a,withCredentials:!0});if(200===o.status){const e=o.data;if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e))throw new Error("invalid user id");if("string"!=typeof e)throw new Error("invalid response");return await bt({key:"user-id",value:e}),await bt({key:"server-id-received",value:"true"}),e}throw new Error("get server id error!")})({baseURL:Ca,path:"/id"}),thirdPartyCookieStorage:{baseURL:Ca,getStorageURL:"/storage/get",setStorageURL:"/storage/update"},enabledSessions:{baseSessions:!1,marketingSessions1:!1,marketingSessions2:!1,marketingSessions3:!0},domObservers:{configs:[{config:{name:"buy_button_rendered",targetSelector:".header__user",parseRootEl:".header__user",parseConfig:{type:"boolean",selector:".header__buy-btn"}}},{config:{name:"lesson_status_rendered",targetSelector:".program__course-card-container",guardSelector:".course-card__body-main-container",parseRootEl:".program__course-card-container",parseConfig:{type:"array",selector:".course-card__body-main-container",items:{type:"object",keys:[{key:"name_course",value:{type:"string",selector:".course-card__title"}},{key:"status",value:{type:"string",selector:".course-card__info-item_active"}}]}}}},{config:{name:"contents_status_rendered",targetSelector:".course-navigation__tab-content_active",guardSelector:".course-card__modal_visible",parseRootEl:".course-navigation__tab-content_active",parseConfig:{type:"array",selector:".course-navigation__scroll-area",items:{type:"object",keys:[{key:"name_table_of_contents",value:{type:"string",selector:".course-navigation__header-title"}},{key:"type_content",value:{type:"string",selector:".course-navigation__title_colored"}},{key:"info_content",value:{type:"array",selector:".course-navigation-item",items:{type:"object",keys:[{key:"name_content",value:{type:"string",selector:".course-navigation-item__title"}},{key:"status_solved",value:{type:"boolean",selector:".icon-tick"}},{key:"status_current",value:{type:"boolean",selector:".icon-dot"}},{key:"status_available_lesson",value:{type:"boolean",selector:".study-item-status_value_available"}},{key:"status_available_topic",value:{type:"boolean",selector:".icon-arrow"}},{key:"status_not_available",value:{type:"boolean",selector:".icon-lock"}}]}}}]}}}},{config:{name:"error_page_rendered",targetSelector:".error-page__container",parseRootEl:".error-page__container",parseConfig:{type:"string",selector:".error-block__title"}}},{params:{throttle:5e3,throttleParams:{trailing:!0}},config:{name:"error_trainer_rendered",targetSelector:".trainer__lesson_type_common",guardSelector:".notification_type_error",parseRootEl:".trainer__lesson_type_common",parseConfig:{type:"array",selector:".trainer__right-column",items:{type:"object",keys:[{key:"code_error",value:{type:"string",selector:".CodeMirror-code"}},{key:"result_error",value:{type:"string",selector:".playground-terminal__stdout_type_logs"}},{key:"message_error",value:{type:"string",selector:".notification__content"}}]}}}},{config:{name:"is_next_button_trainer_rendered",targetSelector:".trainer-result",parseRootEl:".trainer-result",parseConfig:{type:"boolean",selector:".trainer-footer__next-task-button"}}},{params:{throttle:5e3,throttleParams:{trailing:!0}},config:{name:"web_error_trainer_rendered",targetSelector:".trainer__lesson_type_web",guardSelector:".notification_type_error",parseRootEl:".trainer__lesson_type_web",parseConfig:{type:"array",selector:".trainer__body",items:{type:"object",keys:[{key:"code_error",value:{type:"string",selector:".CodeMirror-code"}},{key:"message_error",value:{type:"string",selector:".notification__content"}}]}}}}]},domEvents:{config:{collections:[{name:"disable_hash",events:[{selector:".support-chat__input",sendValue:"plainValue"},{selector:".support-chat__input",sendValue:"plainValue",eventType:"change"},{selector:".ais-SearchBox-input",sendValue:"plainValue"},{selector:".ais-SearchBox-input",sendValue:"plainValue",eventType:"change"}]},{name:"track_paste_event",events:[{selector:".CodeMirror",eventType:"paste",eventCustomName:"paste_code"}]}]}},endpoints:[{name:"default",guard:{fraction:{all:1},filters:[e=>!/bot|googlebot|crawler|spider|robot|crawling/i.test(e.metadata.userAgent),function(e){return"custom-event"!==e.type||!!xa.includes(e.name)}]},transport:(({baseURL:e,path:t,collectCookies:n,cookieDomain:r,source:a,version:s,mapEvent:o,sendCustomEventsData:i="as_it_is"})=>{const l=r||window.location.hostname;let c=Tr("_ym_uid");c||Rr("_ym_uid").then((e=>c=e));let u=Tr("_gid");u||Rr("_gid").then((e=>u=e));let d=Tr("_ga");d||Rr("_ga").then((e=>d=e));const m=e=>`${e}|${c||"none"}|${u||"none"}|${d||"none"}`,f=[()=>Tr("id")||void 0,()=>Tr("userId")||void 0];let p="true"===window.localStorage.getItem("HAS_NETWORK_ERROR");return({event:n,enabledInfo:r})=>{const c=(({mainDomain:e,event:t,enabledInfo:n,version:r,collectCookies:a,source:s,getCombinedUserId:o,getCustomUserIds:i,sendCustomEventsData:l,hasErrors:c,gtmIsOk:u})=>{const d=rn(e),m=Date.now()/1e3|0,f=Date.now(),p=(e=>{if(!e)return null;const t={};let n=!1;return e.forEach((e=>{const r=Tr(e);"string"==typeof r&&(n=!0,t[e]=r)})),n?t:null})(a),_=window,g=e=>1<=e&&e<=i.length?i[e-1]():void 0,v={event_name:t.name,has_matched_config:0,event_auto:0,event_timestamp:m,event_timestamp_ms:f,event_date_local:(new Date).toLocaleString("en-CA",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,timeZoneName:"short",hourCycle:"h23"}).replace(/,/g,""),event_date_moscow:(new Date).toLocaleString("en-CA",{timeZone:"Europe/Moscow",hourCycle:"h23"}).replace(/,/g,""),event_day_week:(new Date).getDay(),user_ip:_.realIP,current_location:t.metadata.currentUrl,current_type:"home",version:r,source:s,title:t.metadata.title,cookies:p?JSON.stringify(p):void 0,user_id:o(t.metadata.userId),custom_user_id_1:g(1),custom_user_id_2:g(2),custom_user_id_3:g(3),custom_user_id_4:g(4),external_referrer:d||void 0,platform:`${(()=>{const e=window,t=e=>e.test(window.navigator.userAgent);switch(!0){case t(/edge/i):return"edge";case t(/opr/i)&&(!!e.opr||!!e.opera):return"opera";case t(/chrome/i)&&!!e.chrome:return"chrome";case t(/trident/i):return"ie";case t(/firefox/i):return"firefox";case t(/safari/i):return"safari";default:return"other"}})()}, ${(()=>{const e=window.navigator.userAgent,t=window.navigator.platform;let n=null;return-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(t)?n="Mac OS":-1!==["iPhone","iPad","iPod"].indexOf(t)?n="iOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(t)?n="Windows":/Android/.test(e)?n="Android":/Linux/.test(t)&&(n="Linux"),n})()}, ${window.innerWidth}x${window.innerHeight}`,index:t.metadata.userEventIndex,client_session_id:t.metadata.windowId,client_session_event_index:t.metadata.windowEventIndex,is_iframe:window.self===window.top?0:1,base_endpoint_enabled_by_rete_fraction:n.enabledByAllEventsFraction?1:0,base_endpoint_enabled_by_ga_fraction:0,base_endpoint_enabled_by_ym_fraction:0,base_endpoint_enabled_by_trigger:0,base_endpoint_enabled_by_force:n.forceEnabledByUser?1:0,base_endpoint_enabled_by_url_parameter:0,base_endpoint_enabled_by_session_fraction:n.enabledBySessionEventsFraction?1:0,base_endpoint_enabled_by_specific_event_fraction:n.enabledByCurrentEventFraction?1:0,base_session_id:t.metadata.baseSessionId,marketing_session_type_1_id:t.metadata.marketingSession1Id,marketing_session_type_2_id:t.metadata.marketingSession2Id,marketing_session_type_3_id:t.metadata.marketingSession3Id,has_network_error:c?1:0,gtm_is_ok:u?1:0};return"dom-event"===t.type?{event_custom_name:t.data.eventCustomName,event_value:t.data.eventValue,event_trigger:t.data.eventTrigger,is_action_event:1,extensive_event_trigger:t.data.extensiveEventTrigger,next_type:t.data.nextLocation?"home":void 0,next_location:t.data.nextLocation,source_selector:t.data.eventConfig.selector,...v}:"dom-observer"===t.type?{dom_info:JSON.stringify(t.data),...v}:"page-state"===t.type?{...t.data.perfInfo,...v}:"pageview"===t.type||"document-visibility"===t.type?{...v}:"session-event"===t.type?{event_value:t.data.reason,params:d||void 0,session_type:t.data.sessionType,...v}:"custom-event"===t.type?{..."as_it_is"===l?t.data:{event_value:JSON.stringify(t.data)},...v}:{...v}})({mainDomain:l,event:n,enabledInfo:r,version:s,source:a,getCombinedUserId:m,getCustomUserIds:f,sendCustomEventsData:i,hasErrors:p,gtmIsOk:$r()});new Dr({baseURL:e}).post(t,{json:o?o(c):c}).catch((e=>{p=!0,window.localStorage.setItem("HAS_NETWORK_ERROR","true")}))}})({source:"yapracticum",baseURL:Ca,path:"/event",version:"2.14.0",sendCustomEventsData:"event_value"})}]},Oa=(({configMap:e,defaultConfig:t})=>{const n=window.location.hostname;for(const{domain:t,config:s}of e){if("."===t[0]&&(a=t,(r=n).includes(a)&&r.indexOf(a)===r.length-a.length))return s;if("."!==t[0]&&n===t)return s}var r,a;return t})({defaultConfig:Ia,configMap:[]});(async e=>{if(function(){const e=function(e){return 1==e||"1"==e||"yes"==e};return e(window.doNotTrack)||navigator&&e(navigator.doNotTrack)||navigator&&e(navigator.msDoNotTrack)||window.external&&window.external.msTrackingProtectionEnabled&&window.external.msTrackingProtectionEnabled()}())return;const t=e.cookieDomain||window.location.hostname;qt.watch((async()=>{await(async e=>{const t={baseSessions:!e.enabledSessions||e.enabledSessions.baseSessions,marketingSessions1:!e.enabledSessions||e.enabledSessions.marketingSessions1,marketingSessions2:!e.enabledSessions||e.enabledSessions.marketingSessions2,marketingSessions3:!e.enabledSessions||e.enabledSessions.marketingSessions3};Ln(t);const n=[];t.baseSessions&&n.push((async e=>{const{newSession:t,mainDomain:n,ignoreSessionDomainsList:r}=e,a=await rn(n),s=an({externalReferrer:a,ignoreSessionDomainsList:r}),o=await kt({key:"rete-last-external-referrer"}).then((({value:e})=>e)),i=async e=>{var n;await cn(),await(n=s?null:a,bt(null===n?{key:"rete-last-external-referrer",value:null}:{key:"rete-last-external-referrer",value:n}));const r=en();await(e=>bt({key:"rete-session-id",value:e}))(r),t((({reason:e,sessionId:t})=>({type:"session-event",name:"start_session",data:{sessionType:"base_session",sessionId:t,reason:e}}))({sessionId:r,reason:e}))};return{onPageLoad:async()=>{const e=null!==a&&!s&&a!==o;return await(async()=>null===await un())()?i("first_session"):await dn()?i("last_session_expired"):e?i("external_referrer"):void 0},checkSessionExpired:async()=>{if(await dn())return i("last_session_expired")},onEvent:async()=>cn()}})({newSession:Tn,mainDomain:e.mainDomain,ignoreSessionDomainsList:e.ignoreSessionDomainsList})),t.marketingSessions1&&n.push((async e=>{const{newSession:t,mainDomain:n,ignoreSessionDomainsList:r}=e,a=rn(n),s=an({externalReferrer:a,ignoreSessionDomainsList:r}),[o,i]=await Promise.all([pn(),_n()]),l=on(),c=async e=>{await mn(),await(e=>{try{return bt({key:"rete_marketing_session_1_last_utm",value:JSON.stringify(e)})}catch(e){}})(l),await(async e=>{if(null===e)return await bt({key:"rete_marketing_session_1_last_external_referrer",value:null});await bt({key:"rete_marketing_session_1_last_external_referrer",value:e})})(s?null:a);const n=en();await(e=>bt({key:"rete-marketing-session-1-id",value:e}))(n),t((({reason:e,sessionId:t})=>({type:"session-event",name:"start_session",data:{sessionType:"marketing_session_1",sessionId:t,reason:e}}))({reason:e,sessionId:n}))};return{onPageLoad:async()=>{return await(async()=>null===await fn())()?c("first_session"):await gn()?c("last_session_expired"):ln(l)?(e=l,(t=i)&&e.utm_source===t.utm_source&&e.utm_medium===t.utm_medium&&e.utm_campaign===t.utm_campaign&&e.utm_content===t.utm_content&&e.utm_term===t.utm_term?Promise.resolve():c("utm_changed")):null===a||s?Promise.resolve():a!==o?c("external_referrer"):Promise.resolve();var e,t},checkSessionExpired:async()=>{if(await gn())return c("last_session_expired")},onEvent:()=>mn()}})({newSession:Tn,mainDomain:e.mainDomain,ignoreSessionDomainsList:e.ignoreSessionDomainsList})),t.marketingSessions2&&n.push((async e=>{const{newSession:t,mainDomain:n,ignoreSessionDomainsList:r}=e,a=rn(n),s=an({externalReferrer:a,ignoreSessionDomainsList:r}),[o,i]=await Promise.all([kt({key:"rete_marketing_session_2_last_external_referrer"}).then((({value:e})=>e)),hn()]),l=on(),c=async e=>{const n=en();var r;await Promise.all([vn(),wn(l),(r=s?null:a,bt(null===r?{key:"rete_marketing_session_2_last_external_referrer",value:null}:{key:"rete_marketing_session_2_last_external_referrer",value:r})),kn(n)]),t((({reason:e,sessionId:t})=>({type:"session-event",name:"start_session",data:{sessionType:"marketing_session_2",sessionId:t,reason:e}}))({reason:e,sessionId:n}))};return{onPageLoad:async()=>{return await(async()=>null===await yn())()?c("first_session"):await bn()?c("last_session_expired"):ln(l)?(e=l,(t=i)&&e.utm_source===t.utm_source&&e.utm_medium===t.utm_medium&&e.utm_campaign===t.utm_campaign&&e.utm_content===t.utm_content&&e.utm_term===t.utm_term&&e.gclid===t.gclid&&e.yclid===t.yclid&&e.ymclid===t.ymclid&&e.fbclid===t.fbclid?void 0:c("utm_changed")):null===a||s?void 0:a!==o?c("external_referrer"):void 0;var e,t},checkSessionExpired:async()=>{if(await bn())return c("last_session_expired")},onEvent:()=>vn()}})({newSession:Tn,mainDomain:e.mainDomain,ignoreSessionDomainsList:e.ignoreSessionDomainsList})),t.marketingSessions3&&n.push((async e=>{const{newSession:t,mainDomain:n,ignoreSessionDomainsList:r}=e,a=rn(n),s=an({externalReferrer:a,ignoreSessionDomainsList:r}),[o,i]=await Promise.all([kt({key:"rete_marketing_session_3_last_external_referrer"}).then((({value:e})=>e)),xn()]),l=on(),c=async e=>{const n=en();var r;await Promise.all([En(),Cn(l),(r=s?null:a,bt(null===r?{key:"rete_marketing_session_3_last_external_referrer",value:null}:{key:"rete_marketing_session_3_last_external_referrer",value:r})),On(n)]),t((({reason:e,sessionId:t})=>({type:"session-event",name:"start_session",data:{sessionType:"marketing_session_3",sessionId:t,reason:e}}))({reason:e,sessionId:n}))};return{onPageLoad:async()=>{return await(async()=>null===await Sn())()?c("first_session"):await In()?c("last_session_expired"):ln(l)&&(e=l,!(t=i)||e.utm_source!==t.utm_source||e.utm_medium!==t.utm_medium||e.utm_campaign!==t.utm_campaign||e.utm_content!==t.utm_content||e.utm_term!==t.utm_term)?c("utm_changed"):null===a||s?void 0:a!==o?c("external_referrer"):void 0;var e,t},checkSessionExpired:async()=>{if(await In())return c("last_session_expired")},onEvent:()=>En()}})({newSession:Tn,mainDomain:e.mainDomain,ignoreSessionDomainsList:e.ignoreSessionDomainsList}));const r=await Promise.all(n);let a;await Promise.all(r.map((e=>Promise.resolve(e.onPageLoad()))));const s=()=>{r.forEach((e=>e.checkSessionExpired())),a=setTimeout(s,1e4)};return s(),Zt.watch((e=>{r.forEach((t=>t.onEvent(e)))})),()=>{clearTimeout(a)}})({enabledSessions:e.enabledSessions,mainDomain:t,ignoreSessionDomainsList:e.ignoreSessionDomainsList}),Cr(),Zn(),((e={})=>{const t=e.guard||tr,n=()=>{Qn({type:"pageview",name:"pageview",data:void 0})};let r;n();let a=er(window.location);const s=()=>{const e=er(window.location);t(e,a)&&n(),a=e,r=setTimeout(s,600)};s()})({guard:e.pageviewGuard}),document.addEventListener("visibilitychange",(()=>{const e="hidden"!=document.visibilityState;nr({name:e?"document_visible":"document_hidden",type:"document-visibility",data:{visible:e}})}),!0),Ft((()=>{(({config:e,rootElement:t=document})=>{Ht(e);const n=(({onEvent:e})=>{let t=[];const n=n=>{if(t.find((e=>e.element===n)))return;const r={element:n,listeners:[]};for(const t of Qt){const a=t=>{e({root:n,event:t})};n.addEventListener(t,a,!0),r.listeners.push({eventType:t,handler:a})}t.push(r)};return{listen:n,listenMany:e=>{for(const t of e)n(t)},stopListening:e=>{const n=t.find((t=>t.element===e));if(n){for(const t of n.listeners)e.removeEventListener(t.eventType,t.handler,{capture:!0});t=t.filter((t=>t.element!==e))}}}})({onEvent:({event:e,root:t})=>{Yt({event:e,root:t})}}),r=(({rootElement:e,collections:t})=>{const n=[];for(const{rootSelector:r}of t){const t=e.querySelector(r||"body");t&&n.push(t)}return n})({rootElement:t,collections:e.collections});n.listenMany(r)})(n),e.domObservers&&(({rootEl:e,configs:t})=>{$n(t);const n=e=>e?.throttleParams?e.throttleParams:{leading:!0},r=t.map((({config:e,params:t})=>({name:e.name,event:t&&t.throttle?qn(Hn,t.throttle,n(t)):Hn})));(({targets:e,onCollect:t,rootEl:n,mainObserverCallback:r})=>{const a=new Mn(n||document.body);a.start(r);for(const n of e){const{mapResult:e}=n,r={name:n.name,selector:n.targetSelector,observerConfig:n.observeConfig||An};a.subscribe((r=>{const{element:a}=r,{guardSelector:s,childGuardSelector:o,guard:i}=n;if(!s||document.querySelector(s)){let s;if(s=n.parseRootEl?"string"==typeof n.parseRootEl?document.querySelector(n.parseRootEl):n.parseRootEl:a,!s)return;if(o&&!s.querySelector(o))return;if(i&&!i(s))return;const l=Un(n.parseConfig,s);t({name:n.name,payload:n.payload,originalEvent:r,parsedContent:e?e(l):l})}}),r),a.observe(r)}})({targets:t.map((({config:e})=>e)),rootEl:e||document.body,onCollect:({name:e,parsedContent:t})=>{const n=r.find((t=>t.name===e));n&&n.event({name:e,parseResult:t},{sid:"-zbi7j"})}})})(e.domObservers),rr()}))})),jt.watch((t=>{if(e.yaCounter){const n=`yaCounter${e.yaCounter}`,r=window;r[n]&&r[n].params({reuser:t})}}));for(const t of e.endpoints)lr(t);const n=e.domEvents?e.domEvents:{config:{collections:[]}};if(n.config.collections=[...n.config.collections,xr],Ke({and:{from:jt,to:At},or:{sid:"-iu8g1g"}}),e.thirdPartyCookieStorage&&It(e.thirdPartyCookieStorage),yt({cookieDomain:t}),await Sr(),e.userIdProvider)try{const t=await Promise.resolve(e.userIdProvider());$t(t)}catch(e){$t()}else $t();(()=>{const e=function(){var e=function(){return window.reteUnhandledEvents=window.reteUnhandledEvents||[],window.reteUnhandledEvents},t=function(){return window.reteDatalayerEvents=window.reteDatalayerEvents||[],window.reteDatalayerEvents};return{add:function(n){var r,a;"function"==typeof(null===(r=window)||void 0===r||null===(a=r.reteTracker)||void 0===a?void 0:a.dispatchCustomEvent)?"custom-event"===n.type&&window.reteTracker.dispatchCustomEvent(n):e().push(n),t().push(n)},getEvents:function(){return t()},getUnhandledEvents:function(){return e()},clearUnhandledEvents:function(){window.reteUnhandledEvents=[]},clear:function(){window.reteUnhandledEvents=[],window.reteDatalayerEvents=[]},registerGlobalHandler:function(e){window.reteTracker=window.reteTracker||{},window.reteTracker.dispatchCustomEvent=e},clearGlobalHandler:function(){window.reteTracker=window.reteTracker||{},delete window.reteTracker.dispatchCustomEvent}}}(),t=e.getUnhandledEvents();for(const e of t)_t(e);e.registerGlobalHandler((e=>{_t(e)})),e.clearUnhandledEvents()})()})(Oa),w({and:[{clock:Pr,filter:function(t){return"object"===e(t)&&"get_nearest_squads"===t.eventCategory&&"custom_events"===t.event&&"number"==typeof t.id},target:_t.prepend((function(e){return{type:"custom-event",name:"yandex_user_id_from_ga",data:e.id}}))}],or:{sid:"qt68xw"}}),w({and:[{clock:Pr,filter:function(t){return"object"===e(t)&&("1_lesson_start_any"===t.eventCategory||"run_code_success"===t.eventCategory)&&"custom_events"===t.event&&"number"==typeof t.eventAction},target:_t.prepend((function(e){return{type:"custom-event",name:"yandex_user_id_from_event_action_ga",data:e.eventAction}}))}],or:{sid:"roiirh"}}),rr.watch((function(){(({checkIntervalMs:e=1e3}={})=>{const t=[],n=e=>{for(const n of t)if(n===e)return!0;return!1},r=()=>{if(window.dataLayer&&"number"==typeof window.dataLayer.length)for(const e of window.dataLayer)n(e)||(t.push(e),Pr(e));setTimeout((()=>r()),e)};r()})()}))})();
//# sourceMappingURL=yapracticum.min.js.map